<!DOCTYPE html>
<html lang="ru">
<head>
   
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diablo III Mod UI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lora:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <script src="data_economy.js"></script>
    <script src="data_guilds.js"></script>
    <script src="data_classes.js"></script>
    <script src="data_skills.js"></script>
    <script src="data_world.js"></script>
    <script src="logic_core.js"></script>
    <script src="logic_ui.js"></script>
    <script src="logic_game.js"></script>
    <script src="logic_calc.js"></script>
    <script src="logic_main.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles_components.css">
</head>
<body>

    <div id="breadcrumb">–ì–õ–ê–í–ù–ê–Ø</div>
    <div class="wallpaper"></div>

    <div class="menu-container rpg-entry-effect">
        <div class="header-title" id="menu-title">Diablo III Mod</div>
        <div id="buttons-area"></div>
    </div>

    <div id="text-window">
        <span class="close-x" onclick="closeWindow()">[X]</span>
        <h2 id="window-title"></h2>
        <div id="window-content"></div>
    </div>

    <button id="reset-btn" onclick="resetProgress()">üóëÔ∏è –°–¢–ï–†–ï–¢–¨ –í–°–ï</button>
    <button id="music-btn" onclick="toggleMusic()">üéµ –ú–£–ó–´–ö–ê</button>
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" oninput="setVolume(this.value)" style="display: none; position: fixed; top: 55px; right: 310px; width: 100px; z-index: 1001;">
    <a href="#" onclick="event.preventDefault(); window.openIframe('https://randstuff.ru/number/');" id="randomizer-btn">üé≤ –†–ê–ù–î–û–ú</a>

    <!-- –í–∏–¥–∂–µ—Ç –∏–∑—É—á–µ–Ω–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤ -->
    <div id="learned-skills-widget" style="position: fixed; top: 110px; right: 310px; width: 180px; max-height: 300px; overflow-y: auto; background: rgba(0,0,0,0.8); border: 1px solid #444; padding: 10px; color: #ccc; font-size: 0.75rem; z-index: 900; display: none; border-radius: 4px;">
        <div style="color: #d4af37; border-bottom: 1px solid #555; margin-bottom: 5px; font-weight: bold; text-align: center;">–ò–ó–£–ß–ï–ù–û</div>
        <div id="learned-skills-content"></div>
    </div>

    <!-- –û–∫–Ω–æ —Å–º–µ—Ä—Ç–∏ -->
    <div id="death-modal">
        <h2>‚ò†Ô∏è –°–ú–ï–†–¢–¨ –ì–ï–†–û–Ø</h2>
        <div id="death-modal-content"></div>
        <div id="death-modal-actions"></div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º—É–∑—ã–∫–∏ -->
    <div id="audio-container" style="position: fixed; bottom: 0; right: 0; width: 1px; height: 1px; opacity: 0; pointer-events: none;">
        <audio id="screamer-sound" src="screamer.mp3" preload="auto"></audio>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –ù–ê–í–´–ö–û–í -->
    <div id="skill-calc-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 700px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 5000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <h2 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">üßÆ –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –ù–ê–í–´–ö–û–í</h2>
        <span class="close-x" onclick="document.getElementById('skill-calc-modal').style.display='none'">[X]</span>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –í—ã–±–æ—Ä -->
            <div>
                <label style="color: #aaa;">–ö–ª–∞—Å—Å:</label>
                <select id="calc-class-select" class="d2-button" style="padding: 5px; margin: 5px 0;" onchange="updateCalcSkills()"></select>
                
                <label style="color: #aaa;">–ù–∞–≤—ã–∫:</label>
                <select id="calc-skill-select" class="d2-button" style="padding: 5px; margin: 5px 0;" onchange="updateCalcRunes()"></select>
                
                <label style="color: #aaa;">–†—É–Ω–∞:</label>
                <select id="calc-rune-select" class="d2-button" style="padding: 5px; margin: 5px 0;" onchange="loadCalcSkillData()"></select>
                
                <hr style="border-color: #333;">
                
                <div style="margin-bottom: 5px;"><span style="color: #66ccff;">‚öîÔ∏è –£—Ä–æ–Ω:</span> <span id="calc-dmg" style="color: #e0e0e0;">0</span>%</div>
                <div style="margin-bottom: 5px;"><span style="color: #a29bfe;">üéØ –û–±–ª–∞—Å—Ç—å:</span> <span id="calc-aoe" style="color: #e0e0e0;" data-value="1">-</span></div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –î–æ–ø –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
            <div>
                <div><span style="color: #ff7979;">‚ùÑÔ∏è –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ:</span> <span id="calc-slow" style="color: #e0e0e0;">0</span>%</div>
                <div><span style="color: #ff7979;">‚ö° –°—Ç–∞–Ω/–§—Ä–∏–∑:</span> <span id="calc-stun" style="color: #e0e0e0;">0</span> —Å–µ–∫</div>
                <div><span style="color: #66ff66;">‚ù§Ô∏è –õ–µ—á–µ–Ω–∏–µ:</span> <span id="calc-heal" style="color: #e0e0e0;">0</span>% HP</div>
                <div><span style="color: #ffd700;">üõ°Ô∏è –ë–∞—Ñ—Ñ –£—Ä–æ–Ω–∞:</span> <span id="calc-buff-dmg" style="color: #e0e0e0;">0</span>%</div>
                <div><span style="color: #ffd700;">üõ°Ô∏è –ë–∞—Ñ—Ñ –ó–∞—â–∏—Ç—ã:</span> <span id="calc-buff-def" style="color: #e0e0e0;">0</span>%</div>
                <div><span style="color: #a29bfe;">‚ö° –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</span> <span id="calc-eff-inc" style="color: #e0e0e0;">0</span>%</div>
                <div><span style="color: #66ccff;">üåÄ –í–æ—Å—Å—Ç. —Ä–µ—Å—É—Ä—Å–∞:</span> <span id="calc-res-gain" style="color: #e0e0e0;">0</span></div>
                <input type="hidden" id="calc-buff-perm" value="false"> <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –±–∞—Ñ—Ñ–æ–≤ -->
                <input type="hidden" id="calc-buff-duration" value="0"> <!-- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞—Ñ—Ñ–∞ -->
                <input type="hidden" id="calc-dmg-amp" value="0"> <!-- –£—Å–∏–ª–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –ø–æ –≤—Ä–∞–≥–∞–º -->
                <input type="hidden" id="calc-dmg-2" value="0"> <!-- –í—Ç–æ—Ä–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —É—Ä–æ–Ω–∞ -->
                <input type="hidden" id="calc-aoe-2" value="1"> <!-- –û–±–ª–∞—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ -->
                
                <div id="calc-synergy-box" style="display:none; margin-top:10px; border-top: 1px dashed #444; padding-top: 5px;">
                    <label style="color: #ff9900; font-size: 0.8rem;">‚öîÔ∏è –õ—É—á—à–∏–π –Ω–∞–≤—ã–∫ –∞—Ç–∞–∫–∏:</label>
                    <select id="calc-synergy-skill" class="d2-button" style="padding: 3px; font-size: 0.75rem; margin: 3px 0;" onchange="calculateSkillCost()"></select>
                </div>
                <input type="hidden" id="calc-cost-red-flat" value="0"> <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∑–∞—Ç—Ä–∞—Ç (–ø–ª–æ—Å–∫–æ–µ) -->
                
                <div id="calc-skill-cost-box" style="display:none; margin-top:5px;">
                    <label style="color: #a29bfe;">üìâ –¶–µ–Ω–∞ –æ—Å–Ω. –Ω–∞–≤—ã–∫–∞:</label> <input type="number" id="calc-main-skill-cost" style="width: 80px;" value="0" oninput="calculateSkillCost()">
                </div>
            </div>
        </div>

        <div style="margin-top: 20px; text-align: center; border-top: 1px solid #5a0000; padding-top: 10px;">
            <div style="font-size: 1.5rem; color: #d4af37; display: flex; align-items: center; justify-content: center;">
                <span>–°–¢–û–ò–ú–û–°–¢–¨: <span id="calc-result" style="font-weight: bold; color: #fff;">0</span> üìñ</span>
                <button class="buy-skill-btn" onclick="buySkill()">–ò–ó–£–ß–ò–¢–¨</button>
            </div>
            <p id="calc-details" style="font-size: 0.8rem; color: #888; margin-top: 5px;"></p>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –û–ü–´–¢–ê -->
    <div id="exp-calc-modal">
        <span class="close-x" onclick="document.getElementById('exp-calc-modal').style.display='none'">[X]</span>
        <h3>üìä –ü–û–î–°–ß–ï–¢ –û–ü–´–¢–ê</h3>
        
        <div class="exp-input-row">
            <label>üíÄ –ú–æ–±—ã:</label>
            <input type="number" id="exp-mobs" value="0" oninput="calculateExp()">
        </div>
        <div class="exp-input-row">
            <label>‚ò†Ô∏è –≠–ª–∏—Ç–∞:</label>
            <input type="number" id="exp-elites" value="0" oninput="calculateExp()">
        </div>
        <div class="exp-input-row">
            <label>üëπ –ë–æ—Å—Å—ã:</label>
            <input type="number" id="exp-bosses" value="0" oninput="calculateExp()">
        </div>

        <div class="exp-result-box" id="exp-result-display">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ...</div>
        <button class="exp-apply-btn" onclick="applyExpCalculation()">‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –°–õ–û–ñ–ù–û–°–¢–ò -->
    <div id="difficulty-calc-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 500px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 5000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <span class="close-x" onclick="document.getElementById('difficulty-calc-modal').style.display='none'">[X]</span>
        <h3 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">üìà –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –°–õ–û–ñ–ù–û–°–¢–ò</h3>
        
        <div id="diff-calc-damage-section">
            <h4 style="color: #ff4444; border-bottom: 1px solid #555; padding-bottom: 5px;">‚öîÔ∏è –£–†–û–ù</h4>
            <div class="exp-input-row"><label>–£—Ä–æ–Ω –≥–µ—Ä–æ—è:</label><input type="number" id="diff-hero-dmg" value="0"></div>
            
            <div class="exp-input-row">
                <label style="font-size:0.8rem;">% –£–º–µ–Ω–∏—è –Ω–∞ –≤–µ—â–∞—Ö:</label>
                <input type="number" id="diff-item-skill-pct" value="0" placeholder="%">
            </div>
            
            <div class="exp-input-row">
                <label style="font-size:0.8rem;">% –£–º–µ–Ω–∏—è (–ê–≤—Ç–æ):</label>
                <div style="text-align:right; flex:1; padding-right:10px; font-size:0.8rem; color:#66ccff;" id="diff-auto-skill-name">–ù–µ—Ç</div>
                <input type="number" id="diff-skill-pct" value="0" readonly style="background:#222; color:#aaa;">
            </div>
            
            <div class="exp-input-row"><label>% –°—Ç–∏—Ö–∏–∏:</label><input type="number" id="diff-elem-pct" value="0" placeholder="%"></div>
            <div class="exp-input-row"><label>% –õ–µ–≥. –∫–∞–º–Ω–∏:</label><input type="number" id="diff-gems-pct" value="0" placeholder="%"></div>
            
            <h4 style="color: #d4af37; border-bottom: 1px solid #555; padding-bottom: 5px; margin-top: 10px;">üì¶ –ö–£–ë –ö–ê–ù–ê–ò</h4>
            <!-- –°–ª–æ—Ç 1 -->
            <div class="exp-input-row" style="gap:5px;">
                <select id="diff-cube-1-type" class="d2-button" style="margin:0; padding:2px; font-size:0.7rem; width:100px;"><option value="dmg">–£—Ä–æ–Ω (–û–±—â)</option><option value="skill">–£—Ä–æ–Ω (–°–∫–∏–ª–ª)</option><option value="tough">–ñ–∏–≤—É—á–µ—Å—Ç—å</option></select>
                <input type="number" id="diff-cube-1-val" value="0" placeholder="%" style="width:60px;">
            </div>
            <!-- –°–ª–æ—Ç 2 -->
            <div class="exp-input-row" style="gap:5px;">
                <select id="diff-cube-2-type" class="d2-button" style="margin:0; padding:2px; font-size:0.7rem; width:100px;"><option value="dmg">–£—Ä–æ–Ω (–û–±—â)</option><option value="skill">–£—Ä–æ–Ω (–°–∫–∏–ª–ª)</option><option value="tough">–ñ–∏–≤—É—á–µ—Å—Ç—å</option></select>
                <input type="number" id="diff-cube-2-val" value="0" placeholder="%" style="width:60px;">
            </div>
            <!-- –°–ª–æ—Ç 3 -->
            <div class="exp-input-row" style="gap:5px;">
                <select id="diff-cube-3-type" class="d2-button" style="margin:0; padding:2px; font-size:0.7rem; width:100px;"><option value="dmg">–£—Ä–æ–Ω (–û–±—â)</option><option value="skill">–£—Ä–æ–Ω (–°–∫–∏–ª–ª)</option><option value="tough">–ñ–∏–≤—É—á–µ—Å—Ç—å</option></select>
                <input type="number" id="diff-cube-3-val" value="0" placeholder="%" style="width:60px;">
            </div>

            <div class="exp-input-row"><label>–£—Ä–æ–Ω –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞:</label><input type="number" id="diff-partner-dmg" value="0"></div>
            <div style="text-align: right; color: #ff4444; font-weight: bold; margin-top: 5px;">
                –ò—Ç–æ–≥–æ –£—Ä–æ–Ω: <span id="diff-total-dmg">0</span>
            </div>
        </div>

        <div id="diff-calc-toughness-section" style="margin-top: 20px;">
            <h4 style="color: #66ff66; border-bottom: 1px solid #555; padding-bottom: 5px;">üõ°Ô∏è –ñ–ò–í–£–ß–ï–°–¢–¨</h4>
            <div class="exp-input-row"><label>‚õëÔ∏è + –í–æ—Å—Å—Ç.:</label><input type="number" id="diff-base-tough" value="0"></div>
            <div class="exp-input-row"><label>–õ–µ–≥–µ–Ω–¥–∞—Ä–∫–∏ (—Ö):</label><input type="number" id="diff-leg-tough" value="1"></div>
            <div class="exp-input-row"><label>–ù–∞–≤—ã–∫–∏ (—Ö):</label><input type="number" id="diff-skill-tough" value="1"></div>
            <div class="exp-input-row"><label>–ü–∞—Å—Å–∏–≤–∫–∏ (—Ö):</label><input type="number" id="diff-pass-tough" value="1"></div>
            <div style="text-align: right; color: #66ff66; font-weight: bold; margin-top: 5px;">
                –ò—Ç–æ–≥–æ –ñ–∏–≤—É—á–µ—Å—Ç—å: <span id="diff-total-tough">0</span>
            </div>
        </div>

        <div style="margin-top: 20px; padding: 10px; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; text-align: center;">
            <div style="font-size: 0.9rem; color: #aaa;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</div>
            <div id="diff-result-tier" style="font-size: 1.5rem; color: #d4af37; font-weight: bold;">-</div>
            <div id="diff-result-details" style="font-size: 0.8rem; color: #ccc; margin-top: 5px;"></div>
        </div>

        <button class="exp-apply-btn" onclick="applyDifficulty()">‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –°–õ–û–ñ–ù–û–°–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–î–ê–ñ–ò –õ–ï–ì –ö–ê–ú–ù–Ø -->
    <div id="sell-leg-gem-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 25px; box-shadow: 0 0 50px #000; font-family: 'Lora', serif; color: #e0e0e0; text-align: center;">
        <span class="close-x" onclick="document.getElementById('sell-leg-gem-modal').style.display='none'">[X]</span>
        <h3 style="color: #ff4444; font-family: 'Cinzel', serif; margin-top: 0;">üìâ –ü–†–û–î–ê–ñ–ê –õ–ï–ì. –ö–ê–ú–ù–Ø</h3>
        
        <div style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0;">
            <label>–ö–ª–∞—Å—Å –∫–∞–º–Ω—è:
                <select id="sell-gem-class" style="width: 100%; padding: 5px; background: #000; border: 1px solid #444; color: #fff;">
                    <option value="3">3 –ö–ª–∞—Å—Å (1.5ü•á)</option>
                    <option value="2">2 –ö–ª–∞—Å—Å (4.5ü•á)</option>
                    <option value="1">1 –ö–ª–∞—Å—Å (7ü•á)</option>
                </select>
            </label>
            <label>–£—Ä–æ–≤–µ–Ω—å –∫–∞–º–Ω—è:
                <input type="number" id="sell-gem-level" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </label>
        </div>

        <button class="death-confirm-btn" onclick="confirmSellLegendaryGem()">–ü–†–û–î–ê–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò –ó–ê–ö–ï–ù–û–í -->
    <div id="zaken-buy-modal">
        <span class="close-x" onclick="document.getElementById('zaken-buy-modal').style.display='none'">[X]</span>
        <h3>üí∞ –ü–û–ö–£–ü–ö–ê –ó–ê–ö–ï–ù–û–í</h3>
        <p id="zaken-price-display" style="color: #aaa; font-size: 0.9rem;"></p>
        
        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label><br>
        <input type="number" id="zaken-count-input" value="1" min="1" oninput="updateZakenTotalCost()">
        <div id="zaken-total-cost" style="margin: 10px 0; font-weight: bold; color: #ffd700;">–ò—Ç–æ–≥–æ: 0ü•à</div>
        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
            <button id="btn-confirm-buy" class="zaken-buy-btn" onclick="confirmBuyZakens()">–ö–£–ü–ò–¢–¨</button>
            <button id="btn-confirm-sell" class="zaken-sell-btn" onclick="confirmSellZakens()">–ü–†–û–î–ê–¢–¨</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –í–í–û–î–ê –ß–ò–°–õ–ê -->
    <div id="custom-prompt-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9990; align-items: center; justify-content: center;">
        <div id="prompt-content" style="width: 90%; max-width: 400px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Cinzel', serif; color: #e0e0e0;">
            <h3 id="prompt-title" style="color: #d4af37; margin-top: 0; font-size: 1.5rem;"></h3>
            <p id="prompt-text" style="font-family: 'Lora', serif; font-size: 1.1rem; margin: 20px 0; line-height: 1.5;"></p>
            <input type="number" id="prompt-input" value="1" min="1" style="width: 100px; padding: 8px; background: #000; border: 1px solid #444; color: #fff; text-align: center; font-size: 1.2rem; margin-bottom: 20px;">
            <div id="prompt-buttons" style="display: flex; justify-content: center; gap: 15px;">
                <button id="prompt-ok-btn" class="death-confirm-btn" style="background: #5a0000; border-color: #d4af37; min-width: 100px;">OK</button>
                <button id="prompt-cancel-btn" class="death-cancel-btn" style="min-width: 100px;">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–û–ë–ê–í–õ–ï–ù–ò–Ø –î–ï–ù–ï–ì -->
    <div id="add-money-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 25px; box-shadow: 0 0 50px #000; font-family: 'Lora', serif; color: #e0e0e0; text-align: center;">
        <span class="close-x" onclick="document.getElementById('add-money-modal').style.display='none'">[X]</span>
        <h3 id="add-money-title" style="color: #d4af37; font-family: 'Cinzel', serif; margin-top: 0;">üí∞ –î–û–ë–ê–í–ò–¢–¨ –°–†–ï–î–°–¢–í–ê</h3>
        
        <div style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label>ü•á –ó–æ–ª–æ—Ç–æ:</label>
                <input type="number" id="add-gold-g" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label>ü•à –°–µ—Ä–µ–±—Ä–æ:</label>
                <input type="number" id="add-gold-s" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label>ü•â –ú–µ–¥—å:</label>
                <input type="number" id="add-gold-c" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label>üßß –ô–µ–Ω–∞:</label>
                <input type="number" id="add-gold-y" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
        </div>

        <button class="death-confirm-btn" onclick="confirmAddMoney()">–î–û–ë–ê–í–ò–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–î–ê–ñ–ò –ö–†–ê–§–¢–ê -->
    <div id="sell-craft-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 600px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <h2 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">–ü—Ä–æ–¥–∞–∂–∞ –∫—Ä–∞—Ñ—á–µ–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞</h2>
        <span class="close-x" onclick="document.getElementById('sell-craft-modal').style.display='none'">[X]</span>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
            <div>
                <label>–£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ–¥–º–µ—Ç–∞: <input type="number" id="craft-sell-level" value="1" min="1" oninput="calculateCraftedSellPrice()" style="width: 60px;"></label>
            </div>
            <div>
                <label>–ì—Ä–µ–π–¥: 
                    <select id="craft-sell-grade" onchange="calculateCraftedSellPrice()" style="margin-right: 10px;">
                        <option value="N">N (üìì)</option>
                        <option value="DC">D/C (üìòüìí)</option>
                        <option value="B">B (üìô)</option>
                        <option value="A">A (üìï)</option>
                        <option value="S">S (–î—Ä–µ–≤–Ω–∏–π)</option>
                        <option value="S+">S+ (–ö–æ–º–ø–ª–µ–∫—Ç)</option>
                        <option value="Spectrum">Spectrum</option>
                    </select>
                </label>
                <span id="craft-sell-guild-bonus" style="font-size: 0.8rem; color: #66ff66;"></span>
            </div>
        </div>

        <div id="craft-sell-properties" style="background: rgba(0,0,0,0.2); border: 1px solid #333; padding: 10px; max-height: 200px; overflow-y: auto; margin-bottom: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
            <!-- –°–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>

        <div id="craft-sell-total" style="text-align: center; font-size: 1.4rem; color: #ffd700; margin: 20px 0; font-family: 'Cinzel', serif;">–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞: 0 üßß</div>
        
        <div style="text-align: center;"><button class="death-confirm-btn" onclick="confirmSellCraftedItem()">–ü–†–û–î–ê–¢–¨</button></div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –£–°–õ–£–ì –Æ–í–ï–õ–ò–†–ê -->
    <div id="gem-service-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 7000; align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 450px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Cinzel', serif; color: #e0e0e0;">
            <h3 id="gem-service-title" style="color: #d4af37; margin-top: 0; font-size: 1.5rem;">–£—Å–ª—É–≥–∏ —é–≤–µ–ª–∏—Ä–∞</h3>
            <div id="gem-service-inputs" style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0;">
                <label>–†–∞–Ω–≥ üíé (1-10): <input type="number" id="gem-rank-input" value="1" min="1" max="10" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <input type="number" id="gem-quantity-input" value="1" min="1" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
                <label id="gem-rent-duration-box" style="display:none;">–ù–∞ —Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π: <input type="number" id="gem-rent-duration" value="1" min="1" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
                <div id="gem-item-type-selector" style="display: flex; gap: 15px; justify-content: center; margin-top: 5px; font-size: 0.9rem;">
                    <label style="cursor: pointer;"><input type="radio" name="gem-item-type" value="1" checked> –û—Ä—É–∂–∏–µ (—Ö1)</label>
                    <label style="cursor: pointer;"><input type="radio" name="gem-item-type" value="0.5"> –î—Ä—É–≥–æ–µ (—Ö0.5)</label>
                </div>
            </div>
            <div id="gem-service-buttons" style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                <!-- Buttons will be generated here by JS -->
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–î–ê–ñ–ò –†–ï–°–£–†–°–û–í -->
    <div id="multi-sell-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 7000; align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 450px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Cinzel', serif; color: #e0e0e0;">
            <h3 id="multi-sell-title" style="color: #d4af37; margin-top: 0; font-size: 1.5rem;">–ü—Ä–æ–¥–∞–∂–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h3>
            <div style="margin-bottom: 15px;">
                <label>–£—Ä–æ–≤–µ–Ω—å —Ä–µ—Å—É—Ä—Å–æ–≤: <input type="number" id="multi-sell-level" value="1" min="1" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
            </div>
            <div id="multi-sell-inputs" style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0; text-align: left;">
                <!-- Inputs will be generated here by JS -->
            </div>
            <div id="multi-sell-total" style="font-size: 1.2rem; color: #ffd700; margin-bottom: 20px;">–ò—Ç–æ–≥–æ: 0 üßß</div>
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="multi-sell-ok-btn" class="death-confirm-btn">–ü—Ä–æ–¥–∞—Ç—å</button>
                <button id="multi-sell-cancel-btn" class="death-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û IFRAME (–í–Ω–µ—à–Ω–∏–µ —Å–∞–π—Ç—ã) -->
    <div id="iframe-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9995; align-items: center; justify-content: center;">
        <div style="width: 95%; height: 90%; position: relative; background: #000; border: 2px solid #d4af37;">
            <span class="close-x" onclick="document.getElementById('iframe-modal').style.display='none'" style="position: absolute; top: -35px; right: 0; color: #fff; font-size: 2rem;">[X]</span>
            <iframe id="web-frame" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>

    <!-- –û–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (Generic) -->
    <div id="custom-confirm-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9990;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 400px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2), inset 0 0 50px rgba(50, 20, 0, 0.5); padding: 25px; text-align: center; font-family: 'Cinzel', serif; font-weight: 700; color: #e0e0e0; border-radius: 4px;">
            <h3 id="confirm-title" style="color: #d4af37; margin-top: 0; text-shadow: 0 0 10px #500; font-size: 1.5rem;">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï</h3>
            <div id="confirm-message" style="font-family: 'Lora', serif; font-size: 1.1rem; margin: 20px 0; line-height: 1.5;"></div>
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="confirm-yes-btn" class="death-confirm-btn" style="background: #5a0000; border-color: #d4af37; min-width: 100px;">–î–ê</button>
                <button id="confirm-no-btn" class="death-cancel-btn" style="min-width: 100px;">–û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
    <div id="mobile-nav-bar">
        <button class="mobile-nav-btn" onclick="toggleMobilePanel('char-sheet', this)">üë§ –ì–ï–†–û–ô</button>
        <button class="mobile-nav-btn" onclick="toggleMobilePanel('right-panels-stack', this)">üìú –ë–û–ù–£–°–´</button>
        <button class="mobile-nav-btn" onclick="toggleEditModal()">‚úçÔ∏è –ö–ù–ò–ì–ê</button>
    </div>

<div id="char-sheet">
    <input type="text" id="input-name" class="char-input name-input" value="–ù–ï–§–ê–õ–ï–ú" onchange="savePlayerData()">
    <div id="view-ladder-rank" style="text-align: center; color: #ff4444; font-size: 0.9rem; margin-bottom: 10px; font-weight: bold; display: none;"></div>
    
    <div class="char-sheet-grid">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="char-sheet-col">
            <div class="stat-group">
                <div class="stat-group-title">–ì–µ—Ä–æ–π</div>
                <div class="stat-row"><span id="view-class">–ö–ª–∞—Å—Å –Ω–µ –≤—ã–±—Ä–∞–Ω</span> <span id="view-build" style="font-size:0.7rem;"></span></div>
                <div class="stat-row">–£—Ä–æ–≤–µ–Ω—å: <input type="number" id="input-lvl" class="char-input" value="1" onchange="savePlayerData()"> üåí <span id="view-xp-bonus" style="font-size:0.7rem; color:#aaa;"></span></div>
                <div class="stat-row">–ó–µ–ª—å—è: <input type="number" id="input-potions" class="char-input" value="5" onchange="savePlayerData()"> üíä <span id="view-potion-price" style="font-size: 0.7rem;"></span></div>
                <div class="stat-row">–ú–∞–∫—Å –í–ü: <input type="number" id="input-max-vp" class="char-input" value="0" onchange="savePlayerData()"> üèõÔ∏è</div>
                <div style="text-align: center; margin-top: 5px; display: flex; justify-content: center; gap: 5px; border-top: 1px solid #333; padding-top: 5px;">
                    <div id="slot-penta-1" class="penta-slot" title="–°–ª–æ—Ç 1 (25 –í–ü)"></div>
                    <div id="slot-penta-2" class="penta-slot" title="–°–ª–æ—Ç 2 (60 –í–ü)"></div>
                    <div id="slot-penta-3" class="penta-slot" title="–°–ª–æ—Ç 3 (100 –í–ü)"></div>
                </div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title">–§–∏–Ω–∞–Ω—Å—ã <span class="add-money-btn" onclick="openAddMoneyModal()" title="–î–æ–±–∞–≤–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞">[+]</span></div>
                <div class="money-row">
                    <span class="money-unit"><input type="number" id="input-gold-g" class="char-input money-input" value="0" onchange="savePlayerData()">ü•á</span>
                    <span class="money-unit"><input type="number" id="input-gold-s" class="char-input money-input" value="0" onchange="savePlayerData()">ü•à</span>
                    <span class="money-unit"><input type="number" id="input-gold-c" class="char-input money-input" value="0" onchange="savePlayerData()">ü•â</span>
                    <span class="money-unit"><input type="number" id="input-gold-y" class="char-input money-input" value="0" onchange="savePlayerData()">üßß</span>
                </div>
                <div class="stat-row" style="margin-top:8px;">–†—É–Ω—ã: <input type="number" id="input-runes" class="char-input" value="0" step="0.1" onchange="savePlayerData()"> üìñ</div>
                <div class="stat-row">–ü–∞—Ä–∞–≥–æ–Ω: <input type="number" id="input-para" class="char-input" value="0" step="0.1" onchange="savePlayerData()"> ‚è≥</div>
                <div class="stat-row">–ó–∞–∫–µ–Ω—ã: <input type="number" id="input-zakens" class="char-input" value="0" onchange="savePlayerData()"> üîñ <span id="view-zaken-discount" style="font-size: 0.7rem;"></span></div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title">–ì–∏–ª—å–¥–∏—è</div>
                <div class="stat-row">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è: <span id="view-profession" class="stat-value">–ù–µ—Ç</span></div>
                <div class="stat-row">–û—Ä–¥–µ–Ω: <span id="view-guild" class="stat-value">–ù–µ—Ç</span></div>
                <div class="stat-row">–†–∞–Ω–≥: <span id="view-rank" class="stat-value">0</span> üßæ</div>
                <div class="stat-row">–ü—Ä–æ–¥–∞–Ω–æ —Ä—É–Ω: <input type="number" id="input-runes-sold" class="char-input" value="0" onchange="savePlayerData()"> üìñ</div>
                <div class="stat-row">–†–µ–ø—É—Ç–∞—Ü–∏—è: <input type="number" id="input-reputation" class="char-input" value="0" onchange="savePlayerData()"> üé≠</div>
                <div class="stat-row">–°–¥–µ–ª–∫–∏: <input type="number" id="input-deals" class="char-input" value="0" onchange="savePlayerData()"> ü§ù</div>
                <div class="stat-row">–°—É–Ω–¥—É–∫–∏: <input type="number" id="input-chests" class="char-input" value="0" onchange="savePlayerData()"> üì¶</div>
                <div class="stat-row">–ö—É–ø–ª–µ–Ω–æ –Ω–∞ –ß–†: <input type="number" id="input-black-market" class="char-input" value="0" onchange="savePlayerData()"> üï∂Ô∏è</div>
                <div class="stat-row">–£–∫—Ä–∞–¥–µ–Ω–æ: <input type="number" id="input-steals" class="char-input" value="0" onchange="savePlayerData()"> <span id="view-theft-fine" style="font-size: 0.6rem;"></span></div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title">–ê—Ç—Ä–∏–±—É—Ç—ã</div>
                <div class="stat-row" id="input-stat-str-box">–°–∏–ª–∞: <input type="number" id="input-stat-str" class="char-input" value="0" onchange="savePlayerData()"> üèÆ</div>
                <div class="stat-row" id="input-stat-dex-box">–õ–æ–≤–∫–æ—Å—Ç—å: <input type="number" id="input-stat-dex" class="char-input" value="0" onchange="savePlayerData()"> ü•¢</div>
                <div class="stat-row" id="input-stat-int-box">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: <input type="number" id="input-stat-int" class="char-input" value="0" onchange="savePlayerData()"> üîÆ</div>
                <div class="stat-row" id="input-stat-vit-box">–ñ–∏–≤—É—á–µ—Å—Ç—å: <input type="number" id="input-stat-vit" class="char-input" value="0" onchange="savePlayerData()"> ‚õëÔ∏è</div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="char-sheet-col">
            <div class="stat-group">
                <div class="stat-group-title">–ë–æ–π –∏ –ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                <div class="stat-row">–£–±–∏—Ç–æ –º–æ–±–æ–≤: <input type="number" id="input-kills" class="char-input" value="0" onchange="savePlayerData()"> üíÄ</div>
                <div class="stat-row">–≠–ª–∏—Ç–∞ (—Å–æ–ª–æ): <input type="number" id="input-elites-solo" class="char-input" value="0" onchange="savePlayerData()"> ‚ò†Ô∏è</div>
                <div class="stat-row">–ë–æ—Å—Å—ã: <input type="number" id="input-bosses" class="char-input" value="0" onchange="savePlayerData()"> üëπ</div>
                <div class="stat-row">–ì–æ–±–ª–∏–Ω—ã: <input type="number" id="input-gobs-solo" class="char-input" value="0" onchange="savePlayerData()">(–°) / <input type="number" id="input-gobs-assist" class="char-input" value="0" onchange="savePlayerData()">(–ü)</div>
                <div class="stat-row" style="font-size: 0.7rem;">–ü–æ—Ä—Ç–∞–ª 70: <input type="text" id="input-lvl70-portal" class="char-input" style="width: 60px;" onchange="savePlayerData()"></div>
                <div class="stat-row">–°–ª–æ–∂–Ω–æ—Å—Ç—å: <span id="view-difficulty" class="stat-value">T1</span></div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title">–õ—É—Ç –∏ –ö—Ä–∞—Ñ—Ç</div>
                <div class="stat-row">–ù–∞–π–¥–µ–Ω–æ –õ–µ–≥: <input type="number" id="input-found-legs" class="char-input" value="0" onchange="savePlayerData()"> üìô</div>
                <div class="stat-row">–ù–∞–π–¥–µ–Ω–æ –ñ–µ–ª—Ç—ã—Ö: <input type="number" id="input-found-yellows" class="char-input" value="0" onchange="savePlayerData()"> üìí</div>
                <div class="stat-row">–†–µ—Å—É—Ä—Å—ã: <input type="number" id="input-res-n" class="char-input" value="0" style="width:30px;" onchange="savePlayerData()">üìì <input type="number" id="input-res-dc" class="char-input" value="0" style="width:30px;" onchange="savePlayerData()">üìòüìí <input type="number" id="input-res-b" class="char-input" value="0" style="width:30px;" onchange="savePlayerData()">üìô <input type="number" id="input-res-a" class="char-input" value="0" style="width:30px;" onchange="savePlayerData()">üìï</div>
                <div class="stat-row">–†–µ–∞–≥–µ–Ω—Ç—ã: <input type="number" id="input-reagents" class="char-input" value="0" onchange="savePlayerData()"></div>
                <div class="stat-row">–î—ã—Ö–∞–Ω–∏–µ —Å–º–µ—Ä—Ç–∏: <input type="number" id="input-death-breath" class="char-input" value="0" onchange="savePlayerData()"> üß™</div>
            </div>
        </div>
    </div>
</div>

<div id="right-panels-stack" style="position: fixed; right: 15px; top: 120px; width: 240px; z-index: 3000; display: flex; flex-direction: column; gap: 10px;">
    
    <!-- –°–≤–∏—Ç–æ–∫ –ì–ò–õ–¨–î–ò–ò -->
    <div id="active-guild-bonus" class="right-panel-bonus" style="display: none; background: linear-gradient(180deg, #1a1a1a 0%, #050505 100%); border: 1px solid #d4af37; padding: 12px; color: #e0e0e0; font-family: 'Marcellus', serif; box-shadow: 0 5px 15px rgba(0,0,0,0.8); border-radius: 2px;">
        <h4 id="bonus-guild-name" style="margin: 0 0 10px 0; color: #d4af37; text-align: center; border-bottom: 1px solid #5a0000; font-size: 0.9rem;">–ì–ò–õ–¨–î–ò–Ø</h4>
        <div id="bonus-content" style="font-size: 0.7rem;"></div>
    </div>

    <!-- –°–≤–∏—Ç–æ–∫ –ö–õ–ê–°–°–ê -->
    <div id="active-class-bonus" class="right-panel-bonus" style="display: none; background: linear-gradient(180deg, #1a1a1a 0%, #0a0a1a 100%); border: 1px solid #66ccff; padding: 12px; color: #e0e0e0; font-family: 'Marcellus', serif; box-shadow: 0 5px 15px rgba(0,0,0,0.8); border-radius: 2px;">
        <h4 id="bonus-class-name" style="margin: 0 0 10px 0; color: #66ccff; text-align: center; border-bottom: 1px solid #003366; font-size: 0.9rem;">–ë–ò–õ–î</h4>
        <div id="class-bonus-content" style="font-size: 0.7rem;"></div>
    </div>

</div>

<!-- –≠–ö–†–ê–ù –ë–ï–ó–î–ï–ô–°–¢–í–ò–Ø (DIABLO) -->
<div id="idle-screen">
        <img id="idle-diablo-img" src="https://upload.wikimedia.org/wikipedia/en/d/d5/Diablo_III_cover.png" onerror="this.style.display='none'" alt="Diablo">
    <div class="fire-wrapper">
        <h1 class="fire-text">–ó–õ–û –ù–ï –î–†–ï–ú–õ–ï–¢...</h1>
        <div class="spark spark-1"></div>
        <div class="spark spark-2"></div>
        <div class="spark spark-3"></div>
        <div class="spark spark-4"></div>
        <div class="spark spark-5"></div>
        <div class="spark spark-6"></div>
    </div>
</div>

</body>
</html>
