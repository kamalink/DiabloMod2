<!DOCTYPE html>
<html lang="ru">
<head>
   
    <meta charset="UTF-8">
    <title>Diablo III Mod UI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lora:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <script src="data_economy.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="data_guilds.js"></script>
    <script src="data_classes.js"></script>
    <script src="data_skills.js"></script>
    <script src="data_world.js"></script>
    <script src="data_hints.js"></script> 
    <script src="logic_core.js"></script>
    <script src="logic_ui.js"></script>
    <script src="logic_game.js"></script>
    <script src="logic_calc_skills.js"></script>
    <script src="logic_calc_exp.js"></script>
    <script src="logic_calc_economy.js"></script>
    <script src="logic_calc_items.js"></script>
    <script src="logic_calc_gameplay.js"></script>
    <script src="logic_main.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles_components.css">
</head>
<body>

    <!-- –≠–∫—Ä–∞–Ω –∑–∞–ø—É—Å–∫–∞ –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞—É–¥–∏–æ -->
    <div id="start-overlay" onclick="window.startGame()">
        <div class="start-text">–ù–ê–ñ–ú–ò–¢–ï –î–õ–Ø –í–•–û–î–ê</div>
    </div>

    <div id="breadcrumb">–ì–õ–ê–í–ù–ê–Ø</div>
    <div class="wallpaper"></div>

    <div class="menu-container">
        <div class="header-title" id="menu-title">Diablo III Mod</div>
        <div id="buttons-area"></div>
    </div>

    <div id="text-window">
        <span class="close-x" onclick="closeWindow()">[X]</span>
        <h2 id="window-title"></h2>
        <div id="window-content"></div>
    </div>

    <button id="reset-btn" class="d2-button" onclick="resetProgress()"><span class="text-gradient-gold">–°–¢–ï–†–ï–¢–¨ –í–°–ï</span><span class="btn-shimmer"></span></button>
    <div id="credits-label">made by Kamalink</div>
    <button id="music-btn" class="d2-button" onclick="toggleMusic()"><span class="text-gradient-gold">–ú–£–ó–´–ö–ê</span><span class="btn-shimmer"></span></button>
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" oninput="setVolume(this.value)" style="display: none; position: fixed; top: 55px; right: 230px; width: 100px; z-index: 1001;">

    <!-- –í–∏–¥–∂–µ—Ç –∏–∑—É—á–µ–Ω–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤ -->
    <div id="learned-skills-widget" class="sidebar-widget" style="position: fixed; top: 110px; right: 310px; width: 180px; max-height: 300px; z-index: 1100; display: none;">
        <div id="learned-skills-title" class="text-gradient-gold" style="border-bottom: 1px solid #555; margin-bottom: 5px; font-weight: bold; text-align: center; cursor: move;">–ò–ó–£–ß–ï–ù–û</div>
        <div id="learned-skills-content"></div>
    </div>
 <!-- –í–∏–¥–∂–µ—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
    <div id="inventory-widget" class="sidebar-widget" style="position: fixed; top: 430px; right: 310px; width: 180px; max-height: 300px; z-index: 900; display: none;">
        <div id="inventory-title" class="text-gradient-gold" style="border-bottom: 1px solid #555; margin-bottom: 5px; font-weight: bold; text-align: center; cursor: move;">–ò–ù–í–ï–ù–¢–ê–†–¨</div>
        <div id="inventory-content"></div>
    </div>
    <!-- –í–∏–¥–∂–µ—Ç –∂—É—Ä–Ω–∞–ª–∞ -->
    <div id="journal-widget" class="sidebar-widget" style="position: fixed; top: 750px; right: 310px; width: 250px; max-height: 200px; z-index: 900; display: none;">
        <div id="journal-title" style="color: #aaa; border-bottom: 1px solid #555; margin-bottom: 5px; font-weight: bold; text-align: center; cursor: move; font-size: 0.8rem;">–ñ–£–†–ù–ê–õ –°–û–ë–´–¢–ò–ô</div>
        <div id="journal-content"></div>
    </div>
    <!-- –û–∫–Ω–æ —Å–º–µ—Ä—Ç–∏ -->
    <div id="death-modal">
        <h2>‚ò†Ô∏è –°–ú–ï–†–¢–¨ –ì–ï–†–û–Ø</h2>
        <div id="death-modal-content"></div>
        <div id="death-modal-actions"></div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º—É–∑—ã–∫–∏ -->
    <div id="audio-container" style="position: fixed; bottom: 0; right: 0; width: 1px; height: 1px; opacity: 0; pointer-events: none;">
        <audio id="screamer-sound" src="screamer.mp3" preload="auto"></audio>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –ù–ê–í–´–ö–û–í -->
       <div id="skill-calc-modal" class="skill-calc-modal-new">
                <h2 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">üó∫Ô∏è –ö–ê–†–¢–ê –ù–ê–í–´–ö–û–í</h2>
        <span class="close-x" onclick="document.getElementById('skill-calc-modal').style.display='none'">[X]</span>
        
        <div class="skill-calc-layout">
            <!-- –õ–ï–í–ê–Ø –ß–ê–°–¢–¨: –î–µ—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤ -->
            <div id="skill-tree-viewport" class="skill-tree-viewport">
                <div id="skill-tree-content" class="skill-tree-content">
                    <!-- –°—é–¥–∞ JS –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–∑–ª—ã –∏ –ª–∏–Ω–∏–∏ -->
                </div>
                <div class="tree-controls">
                     <button onclick="window.toggleSkillTreeEditor()" style="color: #d4af37; border-color: #d4af37;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä</button>
                    <div id="editor-controls" style="display:none; margin-top:5px;">
                        <button onclick="window.saveTreeLayout()" style="color: #66ff66; border-color: #66ff66;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button onclick="window.exportTreeLayout()" style="color: #66ccff; border-color: #66ccff;">üìã –≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button onclick="window.clearTreeLayout()" style="color: #ff4444; border-color: #ff4444;">üóëÔ∏è –°–±—Ä–æ—Å</button>
                    </div>
                    <button onclick="window.resetTreeCamera()">üéØ –¶–µ–Ω—Ç—Ä</button>
                </div>
            </div>

             <!-- –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨: –ò–Ω—Ñ–æ-–ø–∞–Ω–µ–ª—å -->
            <div class="skill-calc-sidebar">
                <div id="calc-class-selector-container" style="margin-bottom: 15px; display: none;">
                                       <label for="calc-class-select" style="color: #aaa;">–ö–ª–∞—Å—Å:</label>
                    <select id="calc-class-select" class="simple-btn" style="width: 100%;" onchange="window.initSkillTree(this.value)"></select>
                </div>

                <h3 id="calc-skill-name" style="color: #d4af37; margin: 0 0 10px 0; border-bottom: 1px solid #555; padding-bottom: 5px;">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–≤—ã–∫</h3>
                
                <div id="calc-runes-container" class="runes-grid"></div>

                <div id="calc-stats-container" style="margin-top: 15px; font-size: 0.85rem; line-height: 1.6;">
                    <!-- –°—é–¥–∞ JS –≤—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—ã -->
                </div>

                <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ -->
                <input type="hidden" id="calc-buff-perm" value="false"> <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –±–∞—Ñ—Ñ–æ–≤ -->
                <input type="hidden" id="calc-buff-duration" value="0"> <!-- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞—Ñ—Ñ–∞ -->
                <input type="hidden" id="calc-dmg-amp" value="0"> <!-- –£—Å–∏–ª–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –ø–æ –≤—Ä–∞–≥–∞–º -->
                <input type="hidden" id="calc-dmg-2" value="0"> <!-- –í—Ç–æ—Ä–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —É—Ä–æ–Ω–∞ -->
                <input type="hidden" id="calc-aoe-2" value="1"> <!-- –û–±–ª–∞—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ -->
                 <input type="hidden" id="calc-cost-red-flat" value="0">
                <input type="hidden" id="calc-skill-idx" value="">
                <input type="hidden" id="calc-rune-idx" value="">
                
                <div id="calc-synergy-box" style="display:none; margin-top:10px; border-top: 1px dashed #444; padding-top: 5px;">
                    <label for="calc-synergy-skill" style="color: #ff9900; font-size: 0.8rem;">‚öîÔ∏è –õ—É—á—à–∏–π –Ω–∞–≤—ã–∫ –∞—Ç–∞–∫–∏:</label>
                    <select id="calc-synergy-skill" class="simple-btn" style="padding: 3px; font-size: 0.75rem; margin: 3px 0; width: 100%;" onchange="calculateSkillCost()"></select>
                </div>
                
                
                <div id="calc-skill-cost-box" style="display:none; margin-top:5px;">
                    <label for="calc-main-skill-cost" style="color: #a29bfe;">üìâ –¶–µ–Ω–∞ –æ—Å–Ω. –Ω–∞–≤—ã–∫–∞:</label> <input type="number" id="calc-main-skill-cost" style="width: 80px;" value="0" oninput="calculateSkillCost()">
                </div>
             <div style="margin-top: auto; padding-top: 15px; border-top: 1px solid #5a0000;">
                    <div style="font-size: 1.2rem; color: #d4af37; text-align: center; margin-bottom: 10px;">
                        <span id="calc-result" style="font-weight: bold; color: #fff;">0</span> üìñ
                    </div>
                    <button class="buy-skill-btn" style="width: 100%; margin: 0;" onclick="buySkill()">–ò–ó–£–ß–ò–¢–¨</button>
                    <p id="calc-details" style="font-size: 0.7rem; color: #888; margin-top: 5px; max-height: 100px; overflow-y: auto;"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –û–ü–´–¢–ê -->
    <div id="exp-calc-modal">
        <span class="close-x" onclick="document.getElementById('exp-calc-modal').style.display='none'">[X]</span>
        <h3>üìä –ü–û–î–°–ß–ï–¢ –û–ü–´–¢–ê</h3>
    
        
        <div class="exp-input-row">
            <label for="exp-mobs">üíÄ –ú–æ–±—ã:</label>
            <div style="display:flex; align-items:center; gap:5px;">
                <span id="exp-partner-kills" style="font-size:0.7rem; color:#888; display:none;" title="–£–±–∏–π—Å—Ç–≤–∞ –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞">(–ù–∞–ø: 0)</span>
                <label id="exp-mobs-contract-label" style="font-size:0.7rem; color:#d4af37; display:none; cursor:pointer; margin-right:5px;" title="–ö–æ–Ω—Ç—Ä–∞–∫—Ç: —Ö3 –∑–æ–ª–æ—Ç–æ">
                    <input type="checkbox" id="exp-mobs-contract-check"> x3
                </label>
                <input type="number" id="exp-mobs" value="0" oninput="calculateExp()">
            </div>
        </div>
        <div class="exp-input-row">
            <label for="exp-elites">‚ò†Ô∏è –≠–ª–∏—Ç–∞:</label>
            <div style="display:flex; align-items:center; gap:5px;">
                <label id="exp-elites-contract-label" style="font-size:0.7rem; color:#d4af37; display:none; cursor:pointer; margin-right:5px;" title="–ö–æ–Ω—Ç—Ä–∞–∫—Ç: —Ö3 –∑–æ–ª–æ—Ç–æ">
                    <input type="checkbox" id="exp-elites-contract-check"> x3
                </label>
                <input type="number" id="exp-elites" value="0" oninput="calculateExp()">
            </div>
        </div>
        <div class="exp-input-row">
            <label for="exp-bosses">üëπ –ë–æ—Å—Å—ã:</label>
            <input type="number" id="exp-bosses" value="0" oninput="calculateExp()">
        </div>
        <div class="exp-input-row" id="exp-chests-row" style="display:none;">
            <label for="exp-chests">üì¶ –°—É–Ω–¥—É–∫–∏:</label>
            <input type="number" id="exp-chests" value="0" oninput="calculateExp()">
        </div>
        <div class="exp-input-row" id="exp-big-chests-row" style="display:none;">
            <label for="exp-big-chests">üß∞ –ë–æ–ª—å—à–∏–µ:</label>
            <input type="number" id="exp-big-chests" value="0" oninput="calculateExp()">
        </div>

        <div class="exp-result-box" id="exp-result-display">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ...</div>
        <button class="exp-apply-btn" onclick="applyExpCalculation()">‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –°–õ–û–ñ–ù–û–°–¢–ò -->
    <div id="difficulty-calc-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 500px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 5000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <span class="close-x" onclick="document.getElementById('difficulty-calc-modal').style.display='none'">[X]</span>
        <h3 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">üìà –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –°–õ–û–ñ–ù–û–°–¢–ò</h3>
        
        <div id="diff-calc-damage-section">
            <h4 style="color: #ff4444; border-bottom: 1px solid #555; padding-bottom: 5px;">‚öîÔ∏è –£–†–û–ù</h4>
            <div class="exp-input-row"><label for="diff-hero-dmg">–£—Ä–æ–Ω –≥–µ—Ä–æ—è:</label><input type="number" id="diff-hero-dmg" value="0"></div>
            
            <div class="exp-input-row">
                <label for="diff-skill-pct" style="font-size:0.8rem;">% –£–º–µ–Ω–∏—è (–ê–≤—Ç–æ):</label>
                <div style="text-align:right; flex:1; padding-right:10px; font-size:0.8rem; color:#66ccff;" id="diff-auto-skill-name">–ù–µ—Ç</div>
                <input type="number" id="diff-skill-pct" value="0" disabled style="background: transparent !important; border: none !important; color: #fff !important; cursor: default !important; width: 70px; text-align: right;">
            </div>
            
            <div class="exp-input-row" style="flex-direction:column; align-items:flex-start; gap:5px;">
                <label for="diff-multipliers" style="width:100%; font-size:0.8rem; color:#d4af37;">–î–æ–ø. –º–Ω–æ–∂–∏—Ç–µ–ª–∏ (%, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                <input type="text" id="diff-multipliers" value="" placeholder="–ù–∞–ø—Ä: 20000, 100, 58" style="width:100%; text-align:left; padding:5px; background:#000; border:1px solid #444; color:#fff;">
            </div>

            <div class="exp-input-row"><label for="diff-partner-dmg">–£—Ä–æ–Ω –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞:</label><input type="number" id="diff-partner-dmg" value="0"></div>
            <div style="text-align: right; color: #ff4444; font-weight: bold; margin-top: 5px;">
                –ò—Ç–æ–≥–æ –£—Ä–æ–Ω: <span id="diff-total-dmg">0</span>
            </div>
        </div>

        <div id="diff-calc-toughness-section" style="margin-top: 20px;">
            <h4 style="color: #66ff66; border-bottom: 1px solid #555; padding-bottom: 5px;">üõ°Ô∏è –ñ–ò–í–£–ß–ï–°–¢–¨</h4>
            <div class="exp-input-row"><label for="diff-base-tough">‚õëÔ∏è + –í–æ—Å—Å—Ç.:</label><input type="number" id="diff-base-tough" value="0"></div>
            
            <!-- Dynamic Fields -->
            <div class="exp-input-row" id="container-reduce-dmg">
                <label for="diff-reduce-dmg-base" style="font-size:0.8rem;">–°–Ω–∏–∂–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ (%):</label>
                <div style="flex:1; display:flex; flex-wrap:wrap; gap:5px; justify-content: flex-end;">
                    <input id="diff-reduce-dmg-base" type="number" class="calc-reduce-dmg" name="calc-reduce-dmg" placeholder="%" style="width:50px; background:#000; border:1px solid #444; color:#fff; text-align:center;" oninput="window.calculateDifficulty()">
                    <button class="simple-btn" style="width:25px; padding:0; margin:0; min-width:unset;" onclick="window.addCalcField('container-reduce-dmg', 'calc-reduce-dmg')">+</button>
                </div>
            </div>
            <div class="exp-input-row" id="container-armor-pct">
                <label for="diff-armor-pct-base" style="font-size:0.8rem;">–ë—Ä–æ–Ω—è (%):</label>
                <div style="flex:1; display:flex; flex-wrap:wrap; gap:5px; justify-content: flex-end;">
                    <input id="diff-armor-pct-base" type="number" class="calc-armor-pct" name="calc-armor-pct" placeholder="%" style="width:50px; background:#000; border:1px solid #444; color:#fff; text-align:center;" oninput="window.calculateDifficulty()">
                    <button class="simple-btn" style="width:25px; padding:0; margin:0; min-width:unset;" onclick="window.addCalcField('container-armor-pct', 'calc-armor-pct')">+</button>
                </div>
            </div>
            <div class="exp-input-row" id="container-dodge-pct">
                <label for="diff-dodge-pct-base" style="font-size:0.8rem;">–£–∫–ª–æ–Ω–µ–Ω–∏–µ (%):</label>
                <div style="flex:1; display:flex; flex-wrap:wrap; gap:5px; justify-content: flex-end;">
                    <input id="diff-dodge-pct-base" type="number" class="calc-dodge-pct" name="calc-dodge-pct" placeholder="%" style="width:50px; background:#000; border:1px solid #444; color:#fff; text-align:center;" oninput="window.calculateDifficulty()">
                    <button class="simple-btn" style="width:25px; padding:0; margin:0; min-width:unset;" onclick="window.addCalcField('container-dodge-pct', 'calc-dodge-pct')">+</button>
                </div>
            </div>
            <div class="exp-input-row" id="container-res-pct">
                <label for="diff-res-pct-base" style="font-size:0.8rem;">–°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ (%):</label>
                <div style="flex:1; display:flex; flex-wrap:wrap; gap:5px; justify-content: flex-end;">
                    <input id="diff-res-pct-base" type="number" class="calc-res-pct" name="calc-res-pct" placeholder="%" style="width:50px; background:#000; border:1px solid #444; color:#fff; text-align:center;" oninput="window.calculateDifficulty()">
                    <button class="simple-btn" style="width:25px; padding:0; margin:0; min-width:unset;" onclick="window.addCalcField('container-res-pct', 'calc-res-pct')">+</button>
                </div>
            </div>

            <div class="exp-input-row"><label for="diff-skill-tough">–ù–∞–≤—ã–∫–∏ (%):</label><input type="number" id="diff-skill-tough" value="0" disabled style="background: transparent !important; border: none !important; color: #fff !important; cursor: default !important; width: 70px; text-align: right;"></div>
            <div class="exp-input-row"><label for="diff-pass-tough">–ü–∞—Å—Å–∏–≤–∫–∏ (%):</label><input type="number" id="diff-pass-tough" value="0" disabled style="background: transparent !important; border: none !important; color: #fff !important; cursor: default !important; width: 70px; text-align: right;"></div>
            
            <div class="exp-input-row" style="flex-direction:column; align-items:flex-start; gap:5px;">
                <label for="diff-tough-multipliers" style="width:100%; font-size:0.8rem; color:#66ff66;">–î–æ–ø. –º–Ω–æ–∂–∏—Ç–µ–ª–∏ (%, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                <input type="text" id="diff-tough-multipliers" value="" placeholder="–ù–∞–ø—Ä: 50, 20" style="width:100%; text-align:left; padding:5px; background:#000; border:1px solid #444; color:#fff;">
            </div>

            <div class="exp-input-row"><label for="diff-partner-tough">–ñ–∏–≤—É—á–µ—Å—Ç—å –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞:</label><input type="number" id="diff-partner-tough" value="0"></div>
            <div style="text-align: right; color: #66ff66; font-weight: bold; margin-top: 5px;">
                –ò—Ç–æ–≥–æ –ñ–∏–≤—É—á–µ—Å—Ç—å: <span id="diff-total-tough">0</span>
            </div>
        </div>

        <div style="margin-top: 20px; padding: 10px; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; text-align: center;">
            <div style="font-size: 0.9rem; color: #aaa;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</div>
            <div id="diff-result-tier" style="font-size: 1.5rem; color: #d4af37; font-weight: bold;">-</div>
            <div id="diff-result-details" style="font-size: 0.8rem; color: #ccc; margin-top: 5px;"></div>
        </div>

        <button class="exp-apply-btn" onclick="applyDifficulty()">‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –°–õ–û–ñ–ù–û–°–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–î–ê–ñ–ò –õ–ï–ì –ö–ê–ú–ù–Ø -->
    <div id="sell-leg-gem-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 25px; box-shadow: 0 0 50px #000; font-family: 'Lora', serif; color: #e0e0e0; text-align: center;">
        <span class="close-x" onclick="document.getElementById('sell-leg-gem-modal').style.display='none'">[X]</span>
        <h3 style="color: #ff4444; font-family: 'Cinzel', serif; margin-top: 0;">üìâ –ü–†–û–î–ê–ñ–ê –õ–ï–ì. –ö–ê–ú–ù–Ø</h3>
        
        <div style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0;">
            <label>–ö–ª–∞—Å—Å –∫–∞–º–Ω—è:
                <select id="sell-gem-class" style="width: 100%; padding: 5px; background: #000; border: 1px solid #444; color: #fff;">
                    <option value="3">3 –ö–ª–∞—Å—Å (1.5ü•á)</option>
                    <option value="2">2 –ö–ª–∞—Å—Å (4.5ü•á)</option>
                    <option value="1">1 –ö–ª–∞—Å—Å (7ü•á)</option>
                </select>
            </label>
            <label>–£—Ä–æ–≤–µ–Ω—å –∫–∞–º–Ω—è:
                <input type="number" id="sell-gem-level" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </label>
        </div>

        <button class="death-confirm-btn" onclick="confirmSellLegendaryGem()">–ü–†–û–î–ê–¢–¨</button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–î–ê–ñ–ò –ö–†–ê–§–¢–ê (–ù–û–í–û–ï) -->
    <div id="sell-craft-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 600px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <span class="close-x" onclick="document.getElementById('sell-craft-modal').style.display='none'">[X]</span>
        <h3 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">‚öíÔ∏è –ü–†–û–î–ê–ñ–ê –ö–†–ê–§–¢–ê</h3>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; background: rgba(0,0,0,0.3); padding: 10px; border: 1px solid #444;">
            <div style="display:flex; flex-direction:column; gap:5px;">
                <label>–£—Ä–æ–≤–µ–Ω—å: 
                    <input type="number" id="modal-sell-level" value="1" min="1" style="width: 60px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
                </label>
                <label>–ì—Ä–µ–π–¥: 
                    <select id="modal-sell-grade" style="background: #000; color: #fff; border: 1px solid #444; width: 60px; cursor: pointer;">
                        <option value="N">N</option>
                        <option value="D">D</option>
                        <option value="C">C</option>
                        <option value="B">B</option>
                        <option value="A">A</option>
                        <option value="S">S</option>
                        <option value="S+">S+</option>
                        <option value="Spectrum">Spec</option>
                    </select>
                </label>
            </div>
            <button class="craft-btn smith-sell" onclick="sellCraftedItemFromModal()">–ü–†–û–î–ê–¢–¨</button>
        </div>
        
        <div id="hand-selector-craft" style="display:none; justify-content:center; gap:15px; margin-bottom:10px;">
            <label style="color:#ff4444; cursor:pointer;"><input type="radio" name="hand-sel-craft" value="right" checked> –ü—Ä–∞–≤–∞—è —Ä—É–∫–∞</label>
            <label style="color:#66ccff; cursor:pointer;"><input type="radio" name="hand-sel-craft" value="left"> –õ–µ–≤–∞—è —Ä—É–∫–∞</label>
        </div>

        <div class="craft-props-container"></div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò –î–†–ï–í–ù–ò–•/–ü–ï–†–í–û–ó–î–ê–ù–ù–´–• -->
    <div id="buy-ancient-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 600px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <span class="close-x" onclick="document.getElementById('buy-ancient-modal').style.display='none'">[X]</span>
        <h3 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">–ö–£–ü–ò–¢–¨ –î–†–ï–í–ù–ò–ô / –ü–ï–†–í–û–ó–î–ê–ù–ù–´–ô</h3>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; background: rgba(0,0,0,0.3); padding: 10px; border: 1px solid #444;">
            <div style="display:flex; flex-direction:column; gap:5px;">
                <label>–£—Ä–æ–≤–µ–Ω—å: 
                    <input type="number" id="ancient-level-input" value="1" min="1" style="width: 60px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
                </label>
                <label>–ì—Ä–µ–π–¥: 
                    <select id="ancient-grade-input" style="background: #000; color: #fff; border: 1px solid #444; width: 70px; cursor: pointer;">
                        <option value="B">B</option>
                        <option value="A">A</option>
                    </select>
                </label>
                <label>–¢–∏–ø: 
                    <select id="ancient-type-input" style="background: #000; color: #fff; border: 1px solid #444; width: 100px; cursor: pointer;">
                        <option value="ancient">–î—Ä–µ–≤–Ω–∏–π</option>
                        <option value="primal">–ü–µ—Ä–≤–æ–∑–¥–∞–Ω–Ω—ã–π</option>
                    </select>
                </label>
            </div>
            <div style="display:flex; gap:5px;">
                <button class="craft-btn sell" onclick="buyAncientImmediate('sell')">–ü–†–û–î–ê–¢–¨</button>
                <button class="craft-btn buy" onclick="buyAncientImmediate('buy')">–ö–£–ü–ò–¢–¨</button>
            </div>
        </div>
        
        <div id="hand-selector-ancient" style="display:none; justify-content:center; gap:15px; margin-bottom:10px;">
            <label style="color:#ff4444; cursor:pointer;"><input type="radio" name="hand-sel-ancient" value="right" checked> –ü—Ä–∞–≤–∞—è —Ä—É–∫–∞</label>
            <label style="color:#66ccff; cursor:pointer;"><input type="radio" name="hand-sel-ancient" value="left"> –õ–µ–≤–∞—è —Ä—É–∫–∞</label>
        </div>

        <div class="ancient-props-container" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
            <!-- Properties will be cloned here by JS or hardcoded -->
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">40%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 40)">–û—Å–Ω–æ–≤–∞ –æ—Ä—É–∂–∏—è</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 40)">–ì–Ω–µ–∑–¥–æ (–±–∏–∂—É—Ç–µ—Ä–∏—è)</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">30%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–û—Å–Ω–æ–≤–∞ –±—Ä–æ–Ω–∏</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–ñ–∏–≤—É—á–µ—Å—Ç—å</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–û—Å–Ω.–•–∞—Ä.</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–ì–Ω–µ–∑–¥–æ (–≥–æ–ª–æ–≤–∞/–æ—Ä—É–∂)</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">20%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 20)">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">15%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–í—Å–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–ö—Ä–∏—Ç —É—Ä–æ–Ω</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–ö—Ä–∏—Ç —à–∞–Ω—Å</span></div>
            </div>
            <div style="flex: 1 1 100%; background: rgba(212, 175, 55, 0.05); border: 1px solid #888; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">10%</div>
                <div style="font-size: 0.85rem; display: grid; grid-template-columns: 1fr 1fr; gap: 5px; text-align: center;">
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ù–µ –û—Å–Ω.–•–∞—Ä.</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ë—Ä–æ–Ω—è</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ó–¥–æ—Ä–æ–≤—å–µ</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä. –≤ –±–∏–∂—É—Ç–µ—Ä–∏–∏</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–°–∫–æ—Ä. –∞—Ç–∞–∫</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ì–Ω–µ–∑–¥–æ (–±—Ä–æ–Ω—è)</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä–æ–Ω —Å—Ç–∏—Ö–∏–∏</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä–æ–Ω —É–º–µ–Ω–∏—è</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">+ –£—Ä. –∫ —Å–∫–∏–ª—É</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–°–Ω–∏–∂. –∑–∞—Ç—Ä–∞—Ç / –ö–î–†</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)" style="grid-column: span 2;">–£—Ä–æ–Ω –ø–æ –æ–±–ª–∞—Å—Ç–∏</span>
                </div>
            </div>
            <div style="flex: 1 1 100%; background: rgba(212, 175, 55, 0.05); border: 1px solid #888; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">5%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–û–¥–Ω–æ —Å–æ–ø—Ä–æ—Ç.</span> | <span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–°–∫–æ—Ä. –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è</span> | <span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–£—Ä–æ–Ω —É–º–µ–Ω—å—à–µ–Ω</span></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò –ö–û–ú–ü–õ–ï–ö–¢–û–í (S+/SPECTRUM) -->
    <div id="buy-set-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 600px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <span class="close-x" onclick="document.getElementById('buy-set-modal').style.display='none'">[X]</span>
        <h3 style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">–ö–£–ü–ò–¢–¨ –ö–û–ú–ü–õ–ï–ö–¢</h3>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; background: rgba(0,0,0,0.3); padding: 10px; border: 1px solid #444;">
            <div style="display:flex; flex-direction:column; gap:5px;">
                <label>–£—Ä–æ–≤–µ–Ω—å: 
                    <input type="number" id="set-level-input" value="1" min="1" style="width: 60px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
                </label>
                <label>–ì—Ä–µ–π–¥: 
                    <select id="set-grade-input" style="background: #000; color: #fff; border: 1px solid #444; width: 100px; cursor: pointer;">
                        <option value="S+">S+</option>
                        <option value="Spectrum">Spectrum</option>
                    </select>
                </label>
                <label>–¢–∏–ø: 
                    <select id="set-type-input" style="background: #000; color: #fff; border: 1px solid #444; width: 100px; cursor: pointer;">
                        <option value="normal">–û–±—ã—á–Ω—ã–π</option>
                        <option value="ancient">–î—Ä–µ–≤–Ω–∏–π</option>
                        <option value="primal">–ü–µ—Ä–≤–æ–∑–¥–∞–Ω–Ω—ã–π</option>
                    </select>
                </label>
                <label>–ü—Ä–µ–¥–º–µ—Ç –ø–æ —Å—á–µ—Ç—É: 
                    <select id="set-count-input" style="background: #000; color: #fff; border: 1px solid #444; width: 100px; cursor: pointer;">
                        <option value="1">1-–π</option>
                        <option value="2">2-–π –∏–ª–∏ 3-–π</option>
                        <option value="4">4-–π –∏–ª–∏ 5-–π</option>
                        <option value="6">6-–π</option>
                    </select>
                </label>
            </div>
            <div style="display:flex; gap:5px;">
                <button class="craft-btn sell" onclick="buySetImmediate('sell')">–ü–†–û–î–ê–¢–¨</button>
                <button class="craft-btn buy" onclick="buySetImmediate('buy')">–ö–£–ü–ò–¢–¨</button>
            </div>
        </div>
        
        <div id="hand-selector-set" style="display:none; justify-content:center; gap:15px; margin-bottom:10px;">
            <label style="color:#ff4444; cursor:pointer;"><input type="radio" name="hand-sel-set" value="right" checked> –ü—Ä–∞–≤–∞—è —Ä—É–∫–∞</label>
            <label style="color:#66ccff; cursor:pointer;"><input type="radio" name="hand-sel-set" value="left"> –õ–µ–≤–∞—è —Ä—É–∫–∞</label>
        </div>

        <div class="set-props-container" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">40%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 40)">–û—Å–Ω–æ–≤–∞ –æ—Ä—É–∂–∏—è</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 40)">–ì–Ω–µ–∑–¥–æ (–±–∏–∂—É—Ç–µ—Ä–∏—è)</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">30%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–û—Å–Ω–æ–≤–∞ –±—Ä–æ–Ω–∏</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–ñ–∏–≤—É—á–µ—Å—Ç—å</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–û—Å–Ω.–•–∞—Ä.</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–ì–Ω–µ–∑–¥–æ (–≥–æ–ª–æ–≤–∞/–æ—Ä—É–∂)</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">20%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 20)">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">15%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–í—Å–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–ö—Ä–∏—Ç —É—Ä–æ–Ω</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–ö—Ä–∏—Ç —à–∞–Ω—Å</span></div>
            </div>
            <div style="flex: 1 1 100%; background: rgba(212, 175, 55, 0.05); border: 1px solid #888; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">10%</div>
                <div style="font-size: 0.85rem; display: grid; grid-template-columns: 1fr 1fr; gap: 5px; text-align: center;">
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ù–µ –û—Å–Ω.–•–∞—Ä.</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ë—Ä–æ–Ω—è</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ó–¥–æ—Ä–æ–≤—å–µ</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä. –≤ –±–∏–∂—É—Ç–µ—Ä–∏–∏</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–°–∫–æ—Ä. –∞—Ç–∞–∫</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ì–Ω–µ–∑–¥–æ (–±—Ä–æ–Ω—è)</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä–æ–Ω —Å—Ç–∏—Ö–∏–∏</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä–æ–Ω —É–º–µ–Ω–∏—è</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">+ –£—Ä. –∫ —Å–∫–∏–ª—É</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–°–Ω–∏–∂. –∑–∞—Ç—Ä–∞—Ç / –ö–î–†</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)" style="grid-column: span 2;">–£—Ä–æ–Ω –ø–æ –æ–±–ª–∞—Å—Ç–∏</span>
                </div>
            </div>
            <div style="flex: 1 1 100%; background: rgba(212, 175, 55, 0.05); border: 1px solid #888; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">5%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–û–¥–Ω–æ —Å–æ–ø—Ä–æ—Ç.</span> | <span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–°–∫–æ—Ä. –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è</span> | <span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–£—Ä–æ–Ω —É–º–µ–Ω—å—à–µ–Ω</span></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò/–ü–†–û–î–ê–ñ–ò A-GRADE (–ö–õ–ê–°–°–´) -->
    <div id="buy-sell-agrade-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 600px; max-height: 90vh; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <span class="close-x" onclick="document.getElementById('buy-sell-agrade-modal').style.display='none'">[X]</span>
        <h3 id="agrade-modal-title" style="color: #d4af37; text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">–û–ü–ï–†–ê–¶–ò–Ø –° –ü–†–ï–î–ú–ï–¢–û–ú</h3>
        <p id="agrade-item-name" style="text-align: center; color: #66ccff; font-weight: bold; margin-bottom: 15px;"></p>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; background: rgba(0,0,0,0.3); padding: 10px; border: 1px solid #444;">
            <div style="display:flex; flex-direction:column; gap:5px;">
                <label>–£—Ä–æ–≤–µ–Ω—å: 
                    <input type="number" id="agrade-level-input" value="1" min="1" style="width: 60px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
                </label>
            </div>
            <button id="agrade-action-btn" class="craft-btn buy" onclick="confirmBuySellAGrade()">–í–´–ü–û–õ–ù–ò–¢–¨</button>
        </div>
        
        <div id="hand-selector-agrade" style="display:none; justify-content:center; gap:15px; margin-bottom:10px;">
            <label style="color:#ff4444; cursor:pointer;"><input type="radio" name="hand-sel-agrade" value="right" checked> –ü—Ä–∞–≤–∞—è —Ä—É–∫–∞</label>
            <label style="color:#66ccff; cursor:pointer;"><input type="radio" name="hand-sel-agrade" value="left"> –õ–µ–≤–∞—è —Ä—É–∫–∞</label>
        </div>

        <div class="agrade-props-container" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">40%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 40)">–û—Å–Ω–æ–≤–∞ –æ—Ä—É–∂–∏—è</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 40)">–ì–Ω–µ–∑–¥–æ (–±–∏–∂—É—Ç–µ—Ä–∏—è)</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">30%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–û—Å–Ω–æ–≤–∞ –±—Ä–æ–Ω–∏</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–ñ–∏–≤—É—á–µ—Å—Ç—å</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–û—Å–Ω.–•–∞—Ä.</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 30)">–ì–Ω–µ–∑–¥–æ (–≥–æ–ª–æ–≤–∞/–æ—Ä—É–∂)</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">20%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 20)">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</span></div>
            </div>
            <div style="flex: 1 1 45%; background: rgba(212, 175, 55, 0.1); border: 1px solid #d4af37; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">15%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–í—Å–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–ö—Ä–∏—Ç —É—Ä–æ–Ω</span><br><span class="buy-prop-item" onclick="toggleBuyProperty(this, 15)">–ö—Ä–∏—Ç —à–∞–Ω—Å</span></div>
            </div>
            <div style="flex: 1 1 100%; background: rgba(212, 175, 55, 0.05); border: 1px solid #888; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">10%</div>
                <div style="font-size: 0.85rem; display: grid; grid-template-columns: 1fr 1fr; gap: 5px; text-align: center;">
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ù–µ –û—Å–Ω.–•–∞—Ä.</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ë—Ä–æ–Ω—è</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ó–¥–æ—Ä–æ–≤—å–µ</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä. –≤ –±–∏–∂—É—Ç–µ—Ä–∏–∏</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–°–∫–æ—Ä. –∞—Ç–∞–∫</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–ì–Ω–µ–∑–¥–æ (–±—Ä–æ–Ω—è)</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä–æ–Ω —Å—Ç–∏—Ö–∏–∏</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–£—Ä–æ–Ω —É–º–µ–Ω–∏—è</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">+ –£—Ä. –∫ —Å–∫–∏–ª—É</span><span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)">–°–Ω–∏–∂. –∑–∞—Ç—Ä–∞—Ç / –ö–î–†</span>
                    <span class="buy-prop-item" onclick="toggleBuyProperty(this, 10)" style="grid-column: span 2;">–£—Ä–æ–Ω –ø–æ –æ–±–ª–∞—Å—Ç–∏</span>
                </div>
            </div>
            <div style="flex: 1 1 100%; background: rgba(212, 175, 55, 0.05); border: 1px solid #888; padding: 8px; border-radius: 4px;">
                <div style="color: #d4af37; font-weight: bold; border-bottom: 1px solid #5a0000; margin-bottom: 5px; text-align: center;">5%</div>
                <div style="font-size: 0.85rem; text-align: center;"><span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–û–¥–Ω–æ —Å–æ–ø—Ä–æ—Ç.</span> | <span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–°–∫–æ—Ä. –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è</span> | <span class="buy-prop-item" onclick="toggleBuyProperty(this, 5)">–£—Ä–æ–Ω —É–º–µ–Ω—å—à–µ–Ω</span></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò –ó–ê–ö–ï–ù–û–í -->
    <div id="zaken-buy-modal">
        <span class="close-x" onclick="document.getElementById('zaken-buy-modal').style.display='none'">[X]</span>
        <h3>–ü–û–ö–£–ü–ö–ê –ó–ê–ö–ï–ù–û–í</h3>
        <p id="zaken-price-display" style="color: #aaa; font-size: 0.9rem;"></p>

        <label for="zaken-count-input">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label><br>
        <input type="number" id="zaken-count-input" name="zaken-count" value="1" min="1" oninput="updateZakenTotalCost()">
        <div id="zaken-total-cost" style="margin: 10px 0; font-weight: bold; color: #ffd700;">–ò—Ç–æ–≥–æ: 0ü•à</div>
        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
            <button id="btn-confirm-buy" class="zaken-buy-btn" onclick="confirmBuyZakens()">–ö–£–ü–ò–¢–¨</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –í–í–û–î–ê –ß–ò–°–õ–ê -->
    <div id="custom-prompt-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9990; align-items: center; justify-content: center;">
        <div id="prompt-content" style="width: 90%; max-width: 400px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Cinzel', serif; color: #e0e0e0;">
            <h3 id="prompt-title" style="color: #d4af37; margin-top: 0; font-size: 1.5rem;"></h3>
            <p id="prompt-text" style="font-family: 'Lora', serif; font-size: 1.1rem; margin: 20px 0; line-height: 1.5;"></p>
            <input type="number" id="prompt-input" value="1" min="1" style="width: 100px; padding: 8px; background: #000; border: 1px solid #444; color: #fff; text-align: center; font-size: 1.2rem; margin-bottom: 20px;">
            <div id="prompt-buttons" style="display: flex; justify-content: center; gap: 15px;">
                <button id="prompt-ok-btn" class="death-confirm-btn" style="background: #5a0000; border-color: #d4af37; min-width: 100px;">OK</button>
                <button id="prompt-cancel-btn" class="death-cancel-btn" style="min-width: 100px;">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–û–ë–ê–í–õ–ï–ù–ò–Ø –î–ï–ù–ï–ì -->
    <div id="add-money-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #1a1a1a; border: 2px solid #d4af37; z-index: 6000; padding: 25px; box-shadow: 0 0 50px #000; font-family: 'Lora', serif; color: #e0e0e0; text-align: center;">
        <span class="close-x" onclick="document.getElementById('add-money-modal').style.display='none'">[X]</span>
        <h3 id="add-money-title" style="color: #d4af37; font-family: 'Cinzel', serif; margin-top: 0;">üí∞ –î–û–ë–ê–í–ò–¢–¨ –°–†–ï–î–°–¢–í–ê</h3>
        
        <div style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label for="add-gold-g">ü•á –ó–æ–ª–æ—Ç–æ:</label>
                <input type="number" id="add-gold-g" name="add-gold-g" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label for="add-gold-s">ü•à –°–µ—Ä–µ–±—Ä–æ:</label>
                <input type="number" id="add-gold-s" name="add-gold-s" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label for="add-gold-c">ü•â –ú–µ–¥—å:</label>
                <input type="number" id="add-gold-c" name="add-gold-c" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label for="add-gold-y">üßß –ô–µ–Ω–∞:</label>
                <input type="number" id="add-gold-y" name="add-gold-y" value="0" min="0" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center;">
            </div>
        </div>

        <button class="death-confirm-btn" onclick="confirmAddMoney()">–î–û–ë–ê–í–ò–¢–¨</button>
    </div>

    

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –£–°–õ–£–ì –Æ–í–ï–õ–ò–†–ê -->
    <div id="gem-service-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 7000; align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 450px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Lora', serif; color: #e0e0e0;">
            <h3 id="gem-service-title" style="color: #d4af37; margin-top: 0; font-size: 1.5rem;">–£—Å–ª—É–≥–∏ —é–≤–µ–ª–∏—Ä–∞</h3>
            <div id="gem-service-inputs" style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0;">
                <label>–†–∞–Ω–≥ üíé (1-10): <input type="number" id="gem-rank-input" value="1" min="1" max="10" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <input type="number" id="gem-quantity-input" value="1" min="1" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
                <label id="gem-rent-duration-box" style="display:none;">–ù–∞ —Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π: <input type="number" id="gem-rent-duration" value="1" min="1" style="width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff;"></label>
                <div id="gem-item-type-selector" style="display: flex; gap: 15px; justify-content: center; margin-top: 5px; font-size: 0.9rem;">
                    <label style="cursor: pointer;"><input type="radio" name="gem-item-type" value="1" checked> –û—Ä—É–∂–∏–µ (—Ö1)</label>
                    <label style="cursor: pointer;"><input type="radio" name="gem-item-type" value="0.5"> –î—Ä—É–≥–æ–µ (—Ö0.5)</label>
                </div>
            </div>
            <div id="gem-service-buttons" style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                <!-- Buttons will be generated here by JS -->
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–î–ê–ñ–ò –†–ï–°–£–†–°–û–í -->
    <div id="multi-sell-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 7000; align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 450px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Lora', serif; color: #e0e0e0;">
            <h3 id="multi-sell-title" style="color: #d4af37; margin-top: 0; font-size: 1.5rem;">–ü—Ä–æ–¥–∞–∂–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h3>
            <div style="margin-bottom: 15px;">
                <label><span id="multi-sell-label-text">–£—Ä–æ–≤–µ–Ω—å —Ä–µ—Å—É—Ä—Å–æ–≤:</span> 
                    <select id="multi-sell-level" style="background: #000; color: #fff; border: 1px solid #444; width: 80px; padding: 5px; cursor: pointer;">
                        <option value="5">1-5</option>
                        <option value="10">6-10</option>
                        <option value="15">11-15</option>
                        <option value="20">16-20</option>
                        <option value="25">21-25</option>
                        <option value="30">26-30</option>
                        <option value="35">31-35</option>
                        <option value="40">36-40</option>
                        <option value="45">41-45</option>
                        <option value="50">46-50</option>
                        <option value="55">51-55</option>
                        <option value="60">56-60</option>
                        <option value="65">61-65</option>
                        <option value="69">66-69</option>
                        <option value="70">70</option>
                    </select>
                </label>
            </div>
            <div id="multi-sell-inputs" style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0; text-align: left;">
                <!-- Inputs will be generated here by JS -->
            </div>
            <div id="multi-sell-total" style="font-size: 1.2rem; color: #ffd700; margin-bottom: 20px;">–ò—Ç–æ–≥–æ: 0 üßß</div>
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="multi-sell-ok-btn" class="death-confirm-btn">–ü—Ä–æ–¥–∞—Ç—å</button>
                <button id="multi-sell-cancel-btn" class="death-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ó–ê–ß–ê–†–û–í–ê–ù–ò–Ø (–ò–ó–ú–ï–ù–ï–ù–ò–ï –°–í–û–ô–°–¢–í) -->
    <div id="enchant-item-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 7000; align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 450px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #a29bfe; box-shadow: 0 0 30px rgba(162, 155, 254, 0.2); padding: 25px; text-align: center; font-family: 'Lora', serif; color: #e0e0e0;">
            <h3 style="color: #a29bfe; margin-top: 0; font-size: 1.5rem;">üîÆ –ò–ó–ú–ï–ù–ï–ù–ò–ï –°–í–û–ô–°–¢–í</h3>
            <p id="enchant-subtitle" style="font-size: 0.8rem; color: #aaa;">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç (N –∏ D –≥—Ä–µ–π–¥—ã –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å).</p>
            
            <div id="enchant-inventory-list" style="max-height: 300px; overflow-y: auto; text-align: left; margin-bottom: 20px; border: 1px solid #444; padding: 5px;">
                <!-- Items will be loaded here -->
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–≤–æ–π—Å—Ç–≤–∞ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div id="enchant-properties-selector" style="display: none;">
                <p style="color: #d4af37;">–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π—Å—Ç–≤–æ –¥–ª—è –∑–∞–º–µ–Ω—ã:</p>
                <div id="enchant-current-props" style="display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; margin-bottom: 15px;"></div>
                
                <p style="color: #66ff66;">–í—ã–±–µ—Ä–∏—Ç–µ –ù–û–í–û–ï —Å–≤–æ–π—Å—Ç–≤–æ:</p>
                <div id="enchant-new-props-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px;">
                    <!-- –°—é–¥–∞ –∫–ª–æ–Ω–∏—Ä—É—é—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ Buy/Sell -->
                </div>
                <div style="margin-top: 15px;">
                    <button class="craft-btn craft" onclick="window.confirmEnchantSwap()">–ó–ê–ú–ï–ù–ò–¢–¨</button>
                    <button class="death-cancel-btn" onclick="window.resetEnchantModal()">–ù–ê–ó–ê–î</button>
                </div>
            </div>

            <button class="death-cancel-btn" onclick="document.getElementById('enchant-item-modal').style.display='none'">–ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–†–ê–ñ–ò (–í–´–ë–û–† –°–í–û–ô–°–¢–í) -->
    <div id="theft-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 600px; max-height: 90vh; background: #1a1a1a; border: 2px solid #444; z-index: 8000; padding: 20px; overflow-y: auto; box-shadow: 0 0 50px #000;">
        <h3 id="theft-modal-title" style="text-align: center; font-family: 'Cinzel', serif; margin-top: 0;">üïµÔ∏è –†–ï–ó–£–õ–¨–¢–ê–¢ –ö–†–ê–ñ–ò</h3>
        <p id="theft-modal-status" style="text-align: center; font-size: 1.1rem; margin-bottom: 15px;"></p>
        
        <div style="text-align: center; margin-bottom: 15px;">
            <span style="color: #aaa;">–ì—Ä–µ–π–¥:</span> <span id="theft-grade-display" style="font-weight: bold; color: #fff;"></span> | 
            <span style="color: #aaa;">–£—Ä–æ–≤–µ–Ω—å:</span> <span id="theft-level-display" style="font-weight: bold; color: #fff;"></span>
        </div>

        <p style="text-align: center; color: #d4af37; font-size: 0.9rem;">–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π—Å—Ç–≤–∞ –ø—Ä–µ–¥–º–µ—Ç–∞:</p>
        
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–≤–æ–π—Å—Ç–≤ (–∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è –∏–∑ Buy/Sell) -->
        <div id="theft-props-container" class="ancient-props-container" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
            <!-- JS –∑–∞–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ -->
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button id="theft-action-btn" class="death-confirm-btn" onclick="window.finalizeTheft()">–ó–ê–í–ï–†–®–ò–¢–¨</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–´–ë–û–†–ê –°–õ–û–ñ–ù–û–°–¢–ò –ü–û–†–¢–ê–õ–ê -->
    <div id="rift-diff-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 8000; align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 400px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); padding: 25px; text-align: center; font-family: 'Lora', serif; color: #e0e0e0;">
            <h3 style="color: #d4af37; margin-top: 0;">–í–´–ë–û–† –°–õ–û–ñ–ù–û–°–¢–ò –ù–ü</h3>
            <p id="rift-diff-cost-display" style="font-family: 'Lora', serif; font-size: 0.9rem; color: #aaa; margin-bottom: 15px;"></p>
            <div id="rift-diff-buttons-container" style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
                <!-- –ö–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
            <button class="death-cancel-btn" onclick="document.getElementById('rift-diff-modal').style.display='none'">–û–¢–ú–ï–ù–ê</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–ö–¢–ò–í–ù–û–ì–û –ü–û–†–¢–ê–õ–ê -->
    <div id="active-rift-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9000; align-items: center; justify-content: center; flex-direction: column;">
        <div style="width: 90%; max-width: 400px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 50px rgba(212, 175, 55, 0.3); padding: 30px; text-align: center; font-family: 'Lora', serif; color: #e0e0e0;">
            <h2 style="color: #d4af37; margin-top: 0; text-shadow: 0 0 10px #d4af37;">üåÄ –ü–û–†–¢–ê–õ –û–¢–ö–†–´–¢</h2>
            <p id="active-rift-info" style="font-family: 'Lora', serif; font-size: 1rem; color: #aaa; margin-bottom: 25px;"></p>
            
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <button class="death-confirm-btn" style="background: #2d5a3a; border-color: #66ff66; font-size: 1rem; padding: 15px;" onclick="window.buyExtraRiftLocation()">üõí –ö–£–ü–ò–¢–¨ –õ–û–ö–ê–¶–ò–Æ</button>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button class="death-confirm-btn" style="background: #1a1a1a; border-color: #66ff66; color: #66ff66; flex: 1;" onclick="window.closeNephalemRift(true)">‚úÖ –ó–ê–ö–†–´–¢</button>
                    <button class="death-confirm-btn" style="background: #1a1a1a; border-color: #ff4444; color: #ff4444; flex: 1;" onclick="window.closeNephalemRift(false)">‚ùå –ù–ï –ó–ê–ö–†–´–¢</button>
                </div>
            </div>
            <p style="font-size: 0.8rem; color: #666; margin-top: 20px;">* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–∞–ª–∞.</p>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û IFRAME (–í–Ω–µ—à–Ω–∏–µ —Å–∞–π—Ç—ã) -->
    <div id="iframe-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9995; align-items: center; justify-content: center;">
        <div style="width: 95%; height: 90%; position: relative; background: #000; border: 2px solid #d4af37;">
            <span class="close-x" onclick="document.getElementById('iframe-modal').style.display='none'" style="position: absolute; top: -35px; right: 0; color: #fff; font-size: 2rem;">[X]</span>
            <iframe id="web-frame" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>

    <!-- –û–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (Generic) -->
    <div id="custom-confirm-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9990;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 400px; background: linear-gradient(160deg, #1a0505 0%, #000 100%); border: 2px solid #d4af37; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2), inset 0 0 50px rgba(50, 20, 0, 0.5); padding: 25px; text-align: center; font-family: 'Cinzel', serif; font-weight: 700; color: #e0e0e0; border-radius: 4px;">
            <h3 id="confirm-title" style="color: #d4af37; margin-top: 0; text-shadow: 0 0 10px #500; font-size: 1.5rem;">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï</h3>
            <div id="confirm-message" style="font-family: 'Lora', serif; font-size: 1.1rem; margin: 20px 0; line-height: 1.5;"></div>
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="confirm-yes-btn" class="death-confirm-btn" style="background: #5a0000; border-color: #d4af37; min-width: 100px;">–î–ê</button>
                <button id="confirm-no-btn" class="death-cancel-btn" style="min-width: 100px;">–û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <div id="save-load-controls" class="ui-element" style="position: fixed; left: 10px; top: 65px; z-index: 1000; display: flex; gap: 10px;">
        <button id="save-btn" class="d2-button" onclick="exportSaveFile()"><span class="text-gradient-gold">–°–û–•–†–ê–ù–ò–¢–¨</span><span class="btn-shimmer"></span></button>
        <button id="load-btn" class="d2-button" onclick="importSaveFile()"><span class="text-gradient-gold">–ó–ê–ì–†–£–ó–ò–¢–¨</span><span class="btn-shimmer"></span></button>
        <button id="import-stats-btn" class="d2-button" onclick="importStatsFromBlizzard(event)"><span class="text-gradient-gold">B.NET –°–¢–ê–¢–´</span><span class="btn-shimmer"></span></button>
        <input type="file" id="load-file-input" style="display: none;" onchange="handleFileSelect(this)" accept=".txt,.json">
    </div>

<div id="char-sheet">
    <input type="text" id="input-name" class="char-input name-input" value="–ù–ï–§–ê–õ–ï–ú" onchange="savePlayerData()">
    <div id="view-ladder-rank" style="text-align: center; color: #ff4444; font-size: 0.9rem; margin-bottom: 10px; font-weight: bold; display: none;"></div>
    
    <div class="char-sheet-grid">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="char-sheet-col">
            <div class="stat-group">
                <div class="stat-group-title"><span class="group-toggle" onclick="window.toggleStatGroup(this)">[-]</span> –ì–µ—Ä–æ–π</div>
                <div class="stat-group-content">
                    <div class="stat-row"><span id="view-class">–ö–ª–∞—Å—Å –Ω–µ –≤—ã–±—Ä–∞–Ω</span> <span id="view-build" style="font-size:0.7rem;"></span></div>
                    <div class="stat-row">–£—Ä.: <input type="number" id="input-lvl" class="char-input" value="1" onchange="savePlayerData()"> üåí <span id="view-xp-bonus" style="font-size:0.7rem; color:#aaa;"></span></div>
                    <div class="stat-row">–ó–µ–ª—å—è: <input type="number" id="input-potions" class="char-input" value="5" onchange="savePlayerData()" disabled> üíä <span id="view-potion-price" style="font-size: 0.7rem;"></span></div>
                    <div class="stat-row">–ú–∞–∫—Å –í–ü: <input type="number" id="input-max-vp" class="char-input" value="0" onchange="savePlayerData()"> üèõÔ∏è</div>
                    <div style="text-align: center; margin-top: 5px; display: flex; justify-content: center; gap: 5px; border-top: 1px solid #333; padding-top: 5px;">
                        <div id="slot-penta-1" class="penta-slot" title="–°–ª–æ—Ç 1 (25 –í–ü)"></div>
                        <div id="slot-penta-2" class="penta-slot" title="–°–ª–æ—Ç 2 (60 –í–ü)"></div>
                        <div id="slot-penta-3" class="penta-slot" title="–°–ª–æ—Ç 3 (100 –í–ü)"></div>
                    </div>
                    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É–ª —Ä–µ—Å—É—Ä—Å–æ–≤ -->
                    <div id="resource-pool" class="resource-pool">
                        <div class="resource-liquid"></div>
                    
                    </div>
                </div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title"><span class="group-toggle" onclick="window.toggleStatGroup(this)">[-]</span> –§–∏–Ω–∞–Ω—Å—ã</div>
                <div class="stat-group-content finance-content" style="position: relative; min-height: 150px;">
                    <div class="finance-inputs">
                        <div class="stat-row">–†—É–Ω—ã: <input type="number" id="input-runes" class="char-input" value="0" step="0.1" onchange="savePlayerData()" disabled> üìñ</div>
                        <div class="stat-row">–ü–∞—Ä–∞–≥–æ–Ω: <input type="number" id="input-para" class="char-input" value="0" step="0.1" onchange="savePlayerData()" disabled> ‚è≥</div>
                        <div class="stat-row">–ó–∞–∫–µ–Ω—ã: <input type="number" id="input-zakens" class="char-input" value="0" onchange="savePlayerData()" disabled> üîñ <span id="view-zaken-discount" style="font-size: 0.7rem;"></span></div>
                    </div>
                    <div class="coin-area-wrapper">
                        <div class="currency-controls">
                            <div class="control-group"><button onmousedown="startCurrencyChange('m', 1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">+</button><button onmousedown="startCurrencyChange('m', -1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">-</button></div>
                            <div class="control-group"><button onmousedown="startCurrencyChange('g', 1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">+</button><button onmousedown="startCurrencyChange('g', -1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">-</button></div>
                            <div class="control-group"><button onmousedown="startCurrencyChange('s', 1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">+</button><button onmousedown="startCurrencyChange('s', -1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">-</button></div>
                            <div class="control-group"><button onmousedown="startCurrencyChange('c', 1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">+</button><button onmousedown="startCurrencyChange('c', -1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">-</button></div>
                            <div class="control-group"><button onmousedown="startCurrencyChange('y', 1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">+</button><button onmousedown="startCurrencyChange('y', -1)" onmouseup="stopCurrencyChange()" onmouseleave="stopCurrencyChange()">-</button></div>
                        </div>
                        <div id="coin-stacks" class="coin-stacks-container">
                            <div id="stack-m" class="coin-stack mithril-stack"></div>
                            <div id="stack-g" class="coin-stack"></div>
                            <div id="stack-s" class="coin-stack"></div>
                            <div id="stack-c" class="coin-stack"></div>
                            <div id="stack-y" class="coin-stack"></div>
                        </div>
                    </div>
                    <div id="view-sell-bonus" style="position: absolute; bottom:120px; left: 0px; width: 100%; text-align: left; font-size: 0.6rem; color: #aaa; pointer-events: none;"></div>
                </div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title"><span class="group-toggle" onclick="window.toggleStatGroup(this)">[-]</span> –ì–∏–ª—å–¥–∏—è</div>
                <div class="stat-group-content">
                    <div class="stat-row">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è: <span id="view-profession" class="stat-value">–ù–µ—Ç</span></div>
                    <div class="stat-row">–û—Ä–¥–µ–Ω: <span id="view-guild" class="stat-value">–ù–µ—Ç</span></div>
                    <div class="stat-row">–†–∞–Ω–≥: <span id="view-rank" class="stat-value">0</span> üßæ</div>
                    <div class="stat-row">–ü—Ä–æ–¥–∞–Ω–æ —Ä—É–Ω: <input type="number" id="input-runes-sold" class="char-input" value="0" onchange="savePlayerData()" disabled> </div>
                    <div class="stat-row">–†–µ–ø—É—Ç–∞—Ü–∏—è: <input type="number" id="input-reputation" class="char-input" value="0" onchange="savePlayerData()" disabled> üé≠</div>
                    <div class="stat-row">–°–¥–µ–ª–∫–∏: <input type="number" id="input-deals" class="char-input" value="0" onchange="savePlayerData()" disabled> ü§ù</div>
                    <div class="stat-row">–°—É–Ω–¥—É–∫–∏: <input type="number" id="input-chests" class="char-input" value="0" onchange="savePlayerData()" disabled> üì¶</div>
                    <div class="stat-row">–£–∫—Ä–∞–¥–µ–Ω–æ: <span id="view-theft-chance" style="font-size: 0.7rem; color: #aaa; margin-right: 3px;"></span><input type="number" id="input-steals" class="char-input" value="0" onchange="savePlayerData()" disabled> <span id="view-theft-fine" style="font-size: 0.6rem;"></span></div>
                </div>
            </div>

            <div class="stat-group">
                <div class="stat-group-title"><span class="group-toggle" onclick="window.toggleStatGroup(this)">[-]</span> –ê—Ç—Ä–∏–±—É—Ç—ã</div>
                 
                <div class="stat-group-content" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex-grow: 1;">
                        <div class="stat-row" id="input-stat-str-box">–°–∏–ª–∞: <input type="number" id="input-stat-str" class="char-input" value="0" onchange="savePlayerData()" disabled> üèÆ</div>
                        <div class="stat-row" id="input-stat-dex-box">–õ–æ–≤–∫–æ—Å—Ç—å: <input type="number" id="input-stat-dex" class="char-input" value="0" onchange="savePlayerData()" disabled> ü•¢</div>
                        <div class="stat-row" id="input-stat-int-box">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: <input type="number" id="input-stat-int" class="char-input" value="0" onchange="savePlayerData()" disabled> üîÆ</div>
                        <div class="stat-row" id="input-stat-vit-box">–ñ–∏–≤—É—á–µ—Å—Ç—å: <input type="number" id="input-stat-vit" class="char-input" value="0" onchange="savePlayerData()" disabled> ‚õëÔ∏è</div>
                    </div>
                    <div class="flasks-container" style="display: flex; gap: 8px; margin-left: 5px;">
                        <!-- –ö–æ–ª–±–∞ –£—Ä–æ–Ω–∞ -->
                        <div id="flask-dmg" class="stat-flask" title="–£—Ä–æ–Ω">
                            <div class="flask-liquid dmg-liquid"></div>
                            <div class="flask-glass"></div>
                        </div>
                        <!-- –ö–æ–ª–±–∞ –ñ–∏–≤—É—á–µ—Å—Ç–∏ -->
                        <div id="flask-tough" class="stat-flask" title="–ñ–∏–≤—É—á–µ—Å—Ç—å">
                            <div class="flask-liquid tough-liquid"></div>
                            <div class="flask-glass"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="char-sheet-col">
            <div class="stat-group">
                <div class="stat-group-title"><span class="group-toggle" onclick="window.toggleStatGroup(this)">[-]</span> –ë–æ–π –∏ –ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                <div class="stat-group-content" style="position: relative;">
                    <div class="stat-row">–£–±–∏—Ç–æ –º–æ–±–æ–≤: <input type="number" id="input-kills" class="char-input" value="0" onchange="savePlayerData()" disabled> üíÄ</div>
                    <div class="stat-row">–≠–ª–∏—Ç–∞ (—Å–æ–ª–æ): <input type="number" id="input-elites-solo" class="char-input" value="0" onchange="savePlayerData()" disabled> ‚ò†Ô∏è</div>
                    <div class="stat-row">–ë–æ—Å—Å—ã: <input type="number" id="input-bosses" class="char-input" value="0" onchange="savePlayerData()" disabled> üëπ</div>
                    <div class="stat-row" style="font-size: 0.7rem; color: #888;">–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ: <input type="number" id="input-base-kills" class="char-input" style="width: 35px;" value="0" onchange="savePlayerData()">üíÄ / <input type="number" id="input-base-elites" class="char-input" style="width: 35px;" value="0" onchange="savePlayerData()">‚ò†Ô∏è</div>
                    <div class="stat-row">–ì–æ–±–ª–∏–Ω—ã: <input type="number" id="input-gobs-solo" class="char-input" value="0" onchange="savePlayerData()" disabled>(–°) / <input type="number" id="input-gobs-assist" class="char-input" value="0" onchange="savePlayerData()" disabled>(–ü)</div>
                    <div class="stat-row" style="font-size: 0.7rem;">–ü–æ—Ä—Ç–∞–ª 70: <input type="text" id="input-lvl70-portal" class="char-input" style="width: 30px;" onchange="savePlayerData()"></div>
<div class="stat-row">–°–ª–æ–∂–Ω–æ—Å—Ç—å: <span id="view-difficulty" class="stat-value">T1</span></div>
                    <div class="stat-row">–ê–∫—Ç: <input type="number" id="input-act" class="char-input" value="1" min="1" max="5" onchange="savePlayerData()"> <span id="view-np-discount" style="font-size: 0.7rem; color: #aaa;"></span></div>
                    
                    <!-- –ö–æ–ª–±–∞ –ó–µ–ª–∏–π (–ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) -->
                    <div id="flask-potions" class="stat-flask potion-flask" title="–ó–µ–ª—å—è –∑–¥–æ—Ä–æ–≤—å—è (–ú–∞–∫—Å 20)" onclick="window.consumePotion()" style="position: absolute; right: 0; top: 45px;">
                            <div class="flask-liquid potion-liquid"></div>
                            <div class="flask-glass"></div>
                            <div class="flask-ticks"></div>
                </div>
            </div>
       </div>

            <div class="stat-group">
                <div class="stat-group-title"><span class="group-toggle" onclick="window.toggleStatGroup(this)">[-]</span> –õ—É—Ç –∏ –ö—Ä–∞—Ñ—Ç</div>
                <div class="stat-group-content">
                    <div class="stat-row">–ù–∞–π–¥–µ–Ω–æ –õ–µ–≥: <input type="number" id="input-found-legs" class="char-input" value="0" onchange="savePlayerData()"> üìô</div>
                    
                    <div class="stat-row">–†–µ—Å—É—Ä—Å—ã: <input type="number" id="input-res-n" class="char-input" value="0" style="width:25px;" onchange="savePlayerData()">üìì <input type="number" id="input-res-dc" class="char-input" value="0" style="width:25px;" onchange="savePlayerData()">üìòüìí <input type="number" id="input-res-b" class="char-input" value="0" style="width:25px;" onchange="savePlayerData()">üìô <input type="number" id="input-res-a" class="char-input" value="0" style="width:25px;" onchange="savePlayerData()">üìï</div>
                    <div class="stat-row">–†–µ–∞–≥–µ–Ω—Ç—ã: <input type="number" id="input-reagents" class="char-input" value="0" onchange="savePlayerData()" disabled></div>
                    <div class="stat-row">–î—ã—Ö–∞–Ω–∏–µ —Å–º–µ—Ä—Ç–∏: <input type="number" id="input-death-breath" class="char-input" value="0" onchange="savePlayerData()"> üß™</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="right-panels-stack" style="position: fixed; right: 15px; top: 120px; width: 240px; z-index: 3000; display: flex; flex-direction: column; gap: 10px;">
    
    <!-- –°–≤–∏—Ç–æ–∫ –ì–ò–õ–¨–î–ò–ò -->
    <div id="active-guild-bonus" class="sidebar-widget" style="display: none;">
        <h4 id="bonus-guild-name" class="text-gradient-gold" style="margin: 0 0 10px 0; text-align: center; border-bottom: 1px solid #5a0000; font-size: 0.9rem;">–ì–ò–õ–¨–î–ò–Ø</h4>
        <div id="bonus-content" style="font-size: 0.7rem;"></div>
    </div>

    <!-- –°–≤–∏—Ç–æ–∫ –ö–õ–ê–°–°–ê -->
    <div id="active-class-bonus" class="sidebar-widget" style="display: none;">
        <h4 id="bonus-class-name" style="margin: 0 0 10px 0; color: #66ccff; text-align: center; border-bottom: 1px solid #003366; font-size: 0.9rem;">–ë–ò–õ–î</h4>
        <div id="class-bonus-content" style="font-size: 0.7rem;"></div>
    </div>

</div>

<!-- –≠–ö–†–ê–ù –ë–ï–ó–î–ï–ô–°–¢–í–ò–Ø (DIABLO) -->
<div id="idle-screen">
    <div class="fire-wrapper">
        <h1 class="fire-text" data-text="–ó–õ–û –ù–ï –î–†–ï–ú–õ–ï–¢...">–ó–õ–û –ù–ï –î–†–ï–ú–õ–ï–¢...</h1>
        <div class="spark"></div>
        <div class="spark"></div>
        <div class="spark"></div>
        <div class="spark"></div>
        <div class="spark"></div>
        <div class="spark"></div>
        <div class="spark"></div>
        <div class="spark"></div>
    </div>

</div>

</body>
</html>
