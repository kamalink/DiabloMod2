/* --- КОМПОНЕНТЫ И АНИМАЦИИ --- */

/* АНИМАЦИИ */
@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes zoomIn {
    from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
    to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}

@keyframes slideInPanel {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Эффект полета для основного окна */
.fly-to-bonus {
    /* Летим вправо-вверх (примерно туда, где панели) и уменьшаемся */
    transform: translate(calc(50vw - 150px), calc(150px - 50vh)) scale(0.05) rotate(15deg) !important;
    opacity: 0 !important;
    filter: brightness(2) blur(2px); /* Эффект вспышки при исчезновении */
    transition: all 0.8s cubic-bezier(0.6, -0.28, 0.735, 0.045); /* Эффект втягивания */
}

/* МОДАЛЬНЫЕ ОКНА */
#death-modal, #exp-calc-modal, #skill-calc-modal, #zaken-buy-modal {
    animation: zoomIn 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28);
}

/* ОКНО КОНТЕНТА (TEXT WINDOW) */
#text-window {
    display: none; position: fixed; top: 50%; left: 50%;
    transform: translate(-50%, -50%); width: 90%; max-width: 550px;
    max-height: 85vh; background: radial-gradient(circle at top, #252525 0%, #0f0f0f 100%);
    border: 2px solid #5a0000; outline: 1px solid var(--theme-border); outline-offset: -5px;
    padding: 35px 25px; overflow-y: auto; z-index: 2000;
}

/* МОДАЛЬНОЕ ОКНО СМЕРТИ */
#death-modal {
    display: none;
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 90%; max-width: 400px;
    background: linear-gradient(160deg, #1a0505 0%, #000 100%);
    border: 2px solid #ff4444;
    box-shadow: 0 0 30px rgba(255, 0, 0, 0.3), inset 0 0 50px rgba(100, 0, 0, 0.2);
    padding: 25px;
    z-index: 3000;
    text-align: center;
    font-family: 'Cinzel', serif; font-weight: 700;
    color: #e0e0e0;
}
#death-modal h2 { color: #ff4444; margin-top: 0; text-shadow: 0 0 10px #500; }
#death-modal-content { font-family: 'Lora', serif; font-size: 1.1rem; margin: 20px 0; line-height: 1.5; }

/* Окно калькулятора опыта */
#exp-calc-modal {
    display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
    width: 90%; max-width: 400px; background: #1a1a1a; border: 2px solid var(--theme-border);
    z-index: 5000; padding: 20px; box-shadow: 0 0 50px #000;
    font-family: 'Lora', serif; color: #e0e0e0;
}
#exp-calc-modal h3 { color: var(--theme-highlight); text-align: center; font-family: 'Cinzel', serif; margin-top: 0; }
.exp-input-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.exp-input-row input { width: 80px; padding: 5px; background: #000; border: 1px solid #444; color: #fff; text-align: center; }
.exp-result-box { 
    background: rgba(255, 255, 255, 0.05); padding: 10px; margin-top: 15px; 
    border: 1px solid #444; text-align: center; 
}

/* ОКНО ПОКУПКИ ЗАКЕНОВ */
#zaken-buy-modal {
    display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
    width: 90%; max-width: 350px; background: #1a1a1a; border: 2px solid var(--theme-border);
    z-index: 6000; padding: 25px; box-shadow: 0 0 50px #000;
    font-family: 'Lora', serif; color: #e0e0e0; text-align: center;
}
#zaken-buy-modal h3 { color: var(--theme-highlight); font-family: 'Cinzel', serif; margin-top: 0; }
#zaken-count-input {
    width: 80px; padding: 8px; background: #000; border: 1px solid #444;
    color: #fff; text-align: center; font-size: 1.2rem; margin: 15px 0;
}

/* ОГНЕННЫЙ ТЕКСТ И ИСКРЫ */
.fire-wrapper {
    position: relative;
    display: inline-block;
}

.fire-text {
    color: #ff4444;
    font-family: 'Exocet', serif;
    margin-top: 20px;
    position: relative;
    z-index: 2;
    animation: floatDiablo 4s ease-in-out infinite reverse, textGlow 1.5s ease-in-out infinite alternate;
}

@keyframes textGlow {
    from { text-shadow: 0 0 10px #8a0000, 0 0 20px #ff0000; }
    to { text-shadow: 0 0 20px #ff0000, 0 0 40px #ff4444, 0 0 60px #ffd700; }
}

.spark {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 4px;
    height: 4px;
    background: #ffd700;
    border-radius: 50%;
    box-shadow: 0 0 5px #ff4444;
    opacity: 0;
    z-index: 1;
    pointer-events: none;
}

.spark-1 { animation: flySpark1 3s linear infinite; }
.spark-2 { animation: flySpark2 4s linear infinite; animation-delay: 1s; }
.spark-3 { animation: flySpark3 3.5s linear infinite; animation-delay: 0.5s; }
.spark-4 { animation: flySpark4 4.5s linear infinite; animation-delay: 2s; }
.spark-5 { animation: flySpark5 3.2s linear infinite; animation-delay: 1.5s; }
.spark-6 { animation: flySpark6 3.8s linear infinite; animation-delay: 0.8s; }

@keyframes flySpark1 { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(-150px, -100px) scale(0); opacity: 0; } }
@keyframes flySpark2 { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(150px, -80px) scale(0); opacity: 0; } }
@keyframes flySpark3 { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(-100px, 120px) scale(0); opacity: 0; } }
@keyframes flySpark4 { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(120px, 100px) scale(0); opacity: 0; } }
@keyframes flySpark5 { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(0px, -150px) scale(0); opacity: 0; } }
@keyframes flySpark6 { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(0px, 150px) scale(0); opacity: 0; } }

/* IDLE SCREEN */
#idle-screen {
    display: none;
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000;
    z-index: 10000;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 1s ease-in-out;
}
#idle-screen.active { display: flex; opacity: 1; }
#idle-diablo-img {
    max-width: 80%; max-height: 70vh;
    filter: drop-shadow(0 0 50px #ff0000);
    animation: floatDiablo 4s ease-in-out infinite;
}
@keyframes floatDiablo {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-20px) scale(1.02); }
}

/* КНОПКИ КАЛЬКУЛЯТОРОВ И МОДАЛОК */
.zaken-buy-btn {
    background: linear-gradient(to bottom, #2d5a3a, #1d3824);
    border: 1px solid #66ff66; color: #fff; padding: 10px 20px;
    min-width: 120px; /* Фиксированная ширина */
    font-family: 'Cinzel', serif; font-weight: 700; cursor: pointer; margin-top: 10px;
}
.zaken-buy-btn:hover { background: #3d7a4a; box-shadow: 0 0 15px rgba(102, 255, 102, 0.4); }

.zaken-sell-btn {
    background: linear-gradient(to bottom, #3a0404, #1a0101);
    border: 1px solid #ff4444; color: #fff; padding: 10px 20px;
    min-width: 120px; /* Фиксированная ширина */
    font-family: 'Cinzel', serif; font-weight: 700; cursor: pointer; margin-top: 10px;
}
.zaken-sell-btn:hover { background: #5a0000; box-shadow: 0 0 15px rgba(255, 68, 68, 0.4); }

.exp-apply-btn {
    width: 100%; padding: 10px; margin-top: 10px;
    background: linear-gradient(to bottom, #2d5a3a, #1d3824);
    border: 1px solid #66ff66; color: #fff; font-family: 'Cinzel', serif; font-weight: 700;
    cursor: pointer;
}
.exp-apply-btn:hover { background: #3d7a4a; }

.buy-skill-btn {
    background: linear-gradient(to bottom, #1d3824, #0f1f13);
    border: 1px solid #66ff66; color: #66ff66;
    padding: 5px 15px; font-family: 'Cinzel', serif; font-weight: 700;
    cursor: pointer; margin-left: 15px; font-size: 1rem; transition: 0.2s;
}
.buy-skill-btn:hover { background: #2d5a3a; box-shadow: 0 0 15px rgba(102, 255, 102, 0.4); transform: scale(1.05); }

.calc-nav-btn {
    display: inline-block; padding: 8px 15px; font-size: 0.8rem;
    background: linear-gradient(to bottom, #222, #111);
    border: 1px solid var(--theme-border); color: var(--theme-highlight);
    font-family: 'Cinzel', serif; font-weight: 700;
    cursor: pointer; margin-left: 10px; vertical-align: middle; transition: transform 0.3s, box-shadow 0.3s, color 0.3s;
}
.calc-nav-btn:hover { background: linear-gradient(to bottom, #333, #222); color: #fff; box-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }

.claim-reward-btn {
    background: linear-gradient(to bottom, #2d5a3a, #1d3824);
    border: 1px solid #66ff66; color: #fff; padding: 10px 20px;
    font-family: 'Cinzel', serif; font-weight: 700; cursor: pointer;
    box-shadow: 0 0 10px rgba(102, 255, 102, 0.3); transition: 0.2s;
}
.claim-reward-btn:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(102, 255, 102, 0.6); }

/* Стили для выпадающего списка навыков в калькуляторе */
#skill-calc-modal #calc-skill-select optgroup {
    font-weight: bold;
    font-style: normal;
    background: #3a2a0a;
    color: #ffcc00;
    padding: 3px 0;
    text-transform: uppercase;
}

#skill-calc-modal select option {
    background: #111;
    color: #ccc;
}

#skill-calc-modal select option[disabled] {
    color: #888 !important;
    font-style: italic;
    font-weight: normal;
    background: #222222;
}

.finance-content {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    gap: 10px;
}

.finance-inputs {
    flex-grow: 1;
}
.coin-area-wrapper {
    position: relative;
    position: absolute; /* Вырываем из потока, чтобы наложить сверху */
    right: 10px;
    bottom: 5px;
    height: 145px; /* Увеличили высоту, чтобы кнопки не обрезались */
     width: 130px;
    pointer-events: none; /* Чтобы клики проходили сквозь пустые места, но кнопки внутри будут работать */

}
/* Увеличенный текст в калькуляторе навыков */
#skill-calc-modal select {
    font-size: 1.1rem;
    padding: 8px;
}
#skill-calc-modal label {
    font-size: 1rem;
}
